<!DOCTYPE html>

<html lang="uk">

<head>

    <meta charset="UTF-8">

    <title>–®–∫–æ–ª–∞ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—ó –º–æ–≤–∏</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">



    <style>

        :root {

            --bg: #0f172a;

            --bg-alt: #111827;

            --bg-deep: #020617;

            --border: #1f2937;

            --text: #e5e7eb;

            --muted: #9ca3af;

            --accent: #3b82f6;

        }



        * { box-sizing: border-box; }



        body {

            margin: 0;

            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;

            background: var(--bg);

            color: var(--text);

        }



        html, body { overflow-x: hidden; }



        .app {

            min-height: 100vh;

            max-width: 100%;

            overflow-x: hidden;

            padding-top: 56px;

        }



        header {

            padding: 0 18px;

            background: #020617dd;

            border-bottom: 1px solid var(--border);

            display: flex;

            align-items: center;

            justify-content: space-between;

            position: fixed;

            top: 0;

            left: 0;

            right: 0;

            width: 100%;

            z-index: 50;

            backdrop-filter: blur(10px);

            height: 56px;

            max-height: 56px;

            min-height: 56px;

            box-sizing: border-box;

            overflow: hidden;

            contain: layout style paint;

            transform: translate3d(0, 0, 0);

            will-change: transform;

            isolation: isolate;

            backface-visibility: hidden;

        }



        .logo { 

            font-weight: 700; 

            font-size: 18px; 

            line-height: 1.2;

            flex-shrink: 0;

        }

        header > div:first-child {

            display: flex;

            align-items: center;

            gap: 8px;

            height: 56px;

            max-height: 56px;

            min-height: 56px;

            padding: 14px 0;

            box-sizing: border-box;

            flex-shrink: 0;

            overflow: hidden;

            transform: translate3d(0, 0, 0);

            backface-visibility: hidden;

        }

        header > div:last-child {

            height: 56px;

            max-height: 56px;

            min-height: 56px;

            display: flex;

            align-items: center;

            padding: 14px 0;

            box-sizing: border-box;

            flex-shrink: 0;

            overflow: hidden;

            transform: translate3d(0, 0, 0);

            backface-visibility: hidden;

        }



        .burger {

            width: 32px;

            height: 24px;

            min-width: 32px;

            max-width: 32px;

            min-height: 24px;

            max-height: 24px;

            display: flex;

            flex-direction: column;

            justify-content: space-between;

            cursor: pointer;

            margin-right: 12px;

            flex-shrink: 0;

            position: relative;

            top: 0;

            left: 0;

            transform: translate3d(0, 0, 0);

            will-change: transform;

            backface-visibility: hidden;

        }



        .burger span {

            height: 3px;

            min-height: 3px;

            width: 100%;

            border-radius: 999px;

            background: var(--text);

            transition: transform 0.3s, opacity 0.3s;

            flex-shrink: 0;

            display: block;

        }



        .sidebar {

            position: fixed;

            top: 0;

            left: 0;

            width: 260px;

            height: 100vh;

            background: var(--bg-alt);

            border-right: 1px solid var(--border);

            padding: 16px;

            transform: translateX(-100%);

            transition: transform 0.3s;

            z-index: 40;

        }



        .sidebar.open { transform: translateX(0); }



        .sidebar-title { font-weight: 700; margin-bottom: 12px; }



        .nav {

            display: flex;

            flex-direction: column;

            gap: 8px;

            margin-top: 12px;

        }



        .nav-button {

            width: 100%;

            text-align: left;

            padding: 10px 12px;

            border-radius: 999px;

            border: 1px solid transparent;

            background: transparent;

            color: var(--muted);

            cursor: pointer;

            font-size: 14px;

        }



        .nav-button:hover {

            background: #020617;

            color: var(--text);

        }



        .nav-button.active {

            background: var(--accent);

            color: white;

            border-color: var(--accent);

        }



        .sidebar-small {

            font-size: 12px;

            color: var(--muted);

            margin-top: 16px;

        }



        .overlay {

            position: fixed;

            inset: 0;

            background: rgba(0, 0, 0, 0.5);

            display: none;

            z-index: 30;

        }



        .overlay.show { display: block; }



        .main {

            max-width: 960px;

            margin: 0 auto;

            padding: 20px 16px 40px;

        }



        .page { display: none; }

        .page-active { display: block; }



        h1, h2 { margin-top: 0; margin-bottom: 12px; }

        p { color: var(--muted); }



        .cards {

            display: grid;

            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));

            gap: 16px;

            margin-top: 24px;

        }



        .card {

            background: var(--bg-alt);

            padding: 18px;

            border-radius: 16px;

            border: 1px solid var(--border);

            font-size: 14px;

        }



        .card h3 { margin-top: 0; margin-bottom: 8px; font-size: 16px; }



        .tag {

            display: inline-block;

            font-size: 11px;

            padding: 4px 8px;

            border-radius: 999px;

            background: #1d4ed8;

            color: #e5e7eb;

            margin-bottom: 6px;

        }



        .btn {

            display: inline-block;

            padding: 9px 18px;

            border-radius: 999px;

            border: none;

            cursor: pointer;

            font-size: 14px;

            font-weight: 600;

            text-decoration: none;

        }



        .btn-primary { background: var(--accent); color: white; }

        .btn-primary:hover { background: #2563eb; }



        .btn-outline {

            background: transparent;

            color: var(--text);

            border: 1px solid #374151;

        }

        .btn-outline:hover { background: var(--bg-alt); }



        .btn-telegram { background: #229ED9; color: white; }

        .btn-telegram:hover { background: #1b7ca8; }



        video, img { width: 100%; border-radius: 12px; }



        label {

            display: block;

            margin-bottom: 6px;

            font-size: 13px;

        }



        input, select {

            width: 100%;

            padding: 9px 10px;

            border-radius: 10px;

            border: 1px solid var(--border);

            background: var(--bg-deep);

            color: var(--text);

            margin-bottom: 10px;

            font-size: 14px;

        }



        input:focus, select:focus { outline: 1px solid var(--accent); }



        .error {

            color: #f97373;

            font-size: 13px;

            margin-bottom: 8px;

        }



        .success {

            color: #22c55e;

            font-size: 13px;

            margin-bottom: 8px;

        }



        .info-row {

            display: flex;

            flex-wrap: wrap;

            gap: 12px;

            margin-top: 16px;

        }



        .info-box {

            flex: 1 1 220px;

            background: var(--bg-deep);

            padding: 10px 12px;

            border-radius: 10px;

            border: 1px solid var(--border);

            font-size: 13px;

        }



        footer {

            text-align: center;

            font-size: 12px;

            color: #6b7280;

            border-top: 1px solid var(--border);

            padding: 16px;

            margin-top: 20px;

        }



        .progress {

            width: 100%;

            height: 10px;

            border-radius: 999px;

            background: #020617;

            margin-top: 8px;

            overflow: hidden;

        }

        .progress-bar {

            height: 100%;

            width: 0;

            background: #22c55e;

            transition: width .3s;

        }

        .progress-text {

            font-size: 12px;

            margin-top: 4px;

            color: var(--muted);

        }



        .weeks-list {

            list-style: none;

            padding-left: 0;

            margin-top: 8px;

            font-size: 12px;

        }

        .weeks-list li { margin-bottom: 2px; }



        .week-form-row {

            display: flex;

            flex-wrap: wrap;

            gap: 8px;

            margin-top: 8px;

        }

        .week-form-row input {

            flex: 1 1 140px;

            margin-bottom: 0;

        }

        .week-form-row button {

            flex: 0 0 auto;

            margin-top: 0;

        }



        .auth-tabs {

            display: flex;

            gap: 8px;

            margin-bottom: 16px;

            border-bottom: 1px solid var(--border);

        }



        .auth-tab {

            padding: 10px 16px;

            background: transparent;

            border: none;

            border-bottom: 2px solid transparent;

            color: var(--muted);

            cursor: pointer;

            font-size: 14px;

            font-weight: 500;

            transition: all 0.2s;

        }



        .auth-tab:hover {

            color: var(--text);

        }



        .auth-tab.active {

            color: var(--accent);

            border-bottom-color: var(--accent);

        }



        .auth-form {

            display: none;

        }



        .auth-form.active {

            display: block;

        }



        .message {

            margin-bottom: 12px;

            padding: 10px 12px;

            border-radius: 10px;

            max-width: 80%;

            word-wrap: break-word;

        }



        .message.teacher {

            background: var(--accent);

            color: white;

            margin-left: auto;

            text-align: right;

        }



        .message.student {

            background: var(--bg-alt);

            color: var(--text);

            border: 1px solid var(--border);

        }



        .message-time {

            font-size: 11px;

            opacity: 0.7;

            margin-top: 4px;

        }



        .student-item {

            padding: 12px;

            background: var(--bg-alt);

            border: 1px solid var(--border);

            border-radius: 10px;

            margin-bottom: 8px;

            cursor: pointer;

            transition: background 0.2s;

        }



        .student-item:hover {

            background: var(--bg-deep);

        }



        .student-item.active {

            background: var(--accent);

            color: white;

        }



        @media (min-width: 900px) {

            .app {

                display: grid;

                grid-template-columns: 260px 1fr;

                padding-top: 56px;

            }



            .sidebar {

                position: static;

                height: auto;

                transform: none;

            }



            .main { padding: 24px 32px 40px; }



            .overlay { display: none !important; }



            .burger { display: none; }

        }



        /* –ö—É—Ä—Å–∏ */

        .course-card {

            background: linear-gradient(135deg, var(--bg-alt) 0%, var(--bg-deep) 100%);

            padding: 24px;

            border-radius: 20px;

            border: 1px solid var(--border);

            position: relative;

            overflow: hidden;

        }

        .course-card::before {

            content: '';

            position: absolute;

            top: 0;

            left: 0;

            right: 0;

            height: 4px;

            background: linear-gradient(90deg, var(--accent), #8b5cf6);

        }

        .course-card.premium::before {

            background: linear-gradient(90deg, #f59e0b, #ef4444);

        }

        .course-price {

            font-size: 32px;

            font-weight: 700;

            color: #22c55e;

            margin: 16px 0;

        }

        .course-price span {

            font-size: 16px;

            color: var(--muted);

        }

        .course-features {

            list-style: none;

            padding: 0;

            margin: 16px 0;

        }

        .course-features li {

            padding: 8px 0;

            color: var(--muted);

            display: flex;

            align-items: center;

            gap: 8px;

        }

        .course-features li::before {

            content: '‚úì';

            color: #22c55e;

            font-weight: bold;

        }

        .course-status {

            display: inline-block;

            padding: 4px 12px;

            border-radius: 999px;

            font-size: 12px;

            font-weight: 600;

            margin-bottom: 12px;

        }

        .course-status.purchased {

            background: #22c55e33;

            color: #22c55e;

        }

        .course-status.pending {

            background: #f59e0b33;

            color: #f59e0b;

        }



        /* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ */

        .modal {

            position: fixed;

            inset: 0;

            background: rgba(0,0,0,0.7);

            display: none;

            align-items: center;

            justify-content: center;

            z-index: 100;

            padding: 20px;

        }

        .modal.show {

            display: flex;

        }

        .modal-content {

            background: var(--bg-alt);

            border-radius: 20px;

            border: 1px solid var(--border);

            max-width: 480px;

            width: 100%;

            max-height: 90vh;

            overflow-y: auto;

            padding: 24px;

        }

        .modal-header {

            display: flex;

            justify-content: space-between;

            align-items: center;

            margin-bottom: 20px;

        }

        .modal-header h2 {

            margin: 0;

        }

        .modal-close {

            background: none;

            border: none;

            color: var(--muted);

            font-size: 24px;

            cursor: pointer;

            padding: 4px;

        }

        .modal-close:hover {

            color: var(--text);

        }

        .payment-card {

            background: var(--bg-deep);

            border: 1px solid var(--border);

            border-radius: 12px;

            padding: 16px;

            text-align: center;

            margin: 16px 0;

        }

        .payment-card-number {

            font-family: monospace;

            font-size: 20px;

            letter-spacing: 2px;

            color: var(--text);

            margin: 8px 0;

        }

        .copy-btn {

            background: var(--accent);

            color: white;

            border: none;

            padding: 6px 12px;

            border-radius: 6px;

            cursor: pointer;

            font-size: 12px;

            margin-top: 8px;

        }

        .copy-btn:hover {

            background: #2563eb;

        }

        .payment-steps {

            text-align: left;

            margin: 16px 0;

        }

        .payment-steps li {

            padding: 8px 0;

            color: var(--muted);

        }

        .payment-steps li strong {

            color: var(--text);

        }

        .btn-success {

            background: #22c55e;

            color: white;

        }

        .btn-success:hover {

            background: #16a34a;

        }

        .btn-monobank {

            background: #000;

            color: white;

            display: inline-flex;

            align-items: center;

            gap: 8px;

        }

        .btn-monobank:hover {

            background: #1a1a1a;

        }



        /* –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å */

        .purchase-item {

            background: var(--bg-deep);

            border: 1px solid var(--border);

            border-radius: 12px;

            padding: 16px;

            margin-bottom: 12px;

        }

        .purchase-item.pending {

            border-left: 4px solid #f59e0b;

        }

        .purchase-item.approved {

            border-left: 4px solid #22c55e;

        }

        .purchase-actions {

            display: flex;

            gap: 8px;

            margin-top: 12px;

        }

        .btn-sm {

            padding: 6px 12px;

            font-size: 12px;

        }

        .btn-approve {

            background: #22c55e;

            color: white;

        }

        .btn-reject {

            background: #ef4444;

            color: white;

        }



        /* –ú–æ—ó –∫—É—Ä—Å–∏ */

        .my-course-item {

            background: var(--bg-deep);

            border: 1px solid var(--border);

            border-radius: 12px;

            padding: 16px;

            margin-bottom: 12px;

            display: flex;

            justify-content: space-between;

            align-items: center;

            flex-wrap: wrap;

            gap: 12px;

        }



        /* ========== –ß–ê–¢ –í–Ü–î–ñ–ï–¢ ========== */

        .chat-widget {

            position: fixed;

            bottom: 20px;

            right: 20px;

            z-index: 1000;

        }

        .chat-toggle {

            width: 60px;

            height: 60px;

            border-radius: 50%;

            background: linear-gradient(135deg, var(--accent), #8b5cf6);

            border: none;

            cursor: pointer;

            display: flex;

            align-items: center;

            justify-content: center;

            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);

            transition: transform 0.3s, box-shadow 0.3s;

        }

        .chat-toggle:hover {

            transform: scale(1.1);

            box-shadow: 0 6px 25px rgba(59, 130, 246, 0.5);

        }

        .chat-toggle svg {

            width: 28px;

            height: 28px;

            fill: white;

        }

        .chat-toggle .badge {

            position: absolute;

            top: -5px;

            right: -5px;

            background: #ef4444;

            color: white;

            font-size: 12px;

            font-weight: 700;

            width: 22px;

            height: 22px;

            border-radius: 50%;

            display: flex;

            align-items: center;

            justify-content: center;

        }

        .chat-box {

            position: absolute;

            bottom: 70px;

            right: 0;

            width: 350px;

            max-width: calc(100vw - 40px);

            height: 450px;

            background: var(--bg-alt);

            border: 1px solid var(--border);

            border-radius: 20px;

            display: none;

            flex-direction: column;

            overflow: hidden;

            box-shadow: 0 10px 40px rgba(0,0,0,0.3);

        }

        .chat-box.open {

            display: flex;

        }

        .chat-header {

            padding: 16px;

            background: linear-gradient(135deg, var(--accent), #8b5cf6);

            color: white;

            display: flex;

            justify-content: space-between;

            align-items: center;

        }

        .chat-header h3 {

            margin: 0;

            font-size: 16px;

        }

        .chat-header .online {

            font-size: 12px;

            opacity: 0.8;

            display: flex;

            align-items: center;

            gap: 6px;

        }

        .chat-header .online::before {

            content: '';

            width: 8px;

            height: 8px;

            background: #22c55e;

            border-radius: 50%;

        }

        .chat-close {

            background: none;

            border: none;

            color: white;

            font-size: 24px;

            cursor: pointer;

            opacity: 0.8;

        }

        .chat-close:hover {

            opacity: 1;

        }

        .chat-messages {

            flex: 1;

            overflow-y: auto;

            padding: 16px;

            display: flex;

            flex-direction: column;

            gap: 12px;

        }

        .chat-input-area {

            padding: 12px;

            border-top: 1px solid var(--border);

            display: flex;

            gap: 8px;

        }

        .chat-input-area input {

            flex: 1;

            margin-bottom: 0;

            border-radius: 20px;

            padding: 10px 16px;

        }

        .chat-input-area button {

            width: 44px;

            height: 44px;

            border-radius: 50%;

            border: none;

            background: var(--accent);

            color: white;

            cursor: pointer;

            display: flex;

            align-items: center;

            justify-content: center;

        }

        .chat-login-msg {

            text-align: center;

            padding: 20px;

            color: var(--muted);

        }



        /* ========== –¢–ê–†–ò–§–ò ========== */

        .tariffs-grid {

            display: grid;

            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));

            gap: 20px;

            margin-top: 24px;

        }

        .tariff-card {

            background: var(--bg-alt);

            border: 2px solid var(--border);

            border-radius: 24px;

            padding: 28px 24px;

            position: relative;

            transition: transform 0.3s, border-color 0.3s, box-shadow 0.3s;

        }

        .tariff-card:hover {

            transform: translateY(-5px);

            box-shadow: 0 10px 30px rgba(0,0,0,0.2);

        }

        .tariff-card.recommended {

            border-color: var(--accent);

            background: linear-gradient(180deg, rgba(59, 130, 246, 0.1) 0%, var(--bg-alt) 100%);

        }

        .tariff-card.recommended::before {

            content: '‚≠ê –†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–û';

            position: absolute;

            top: -12px;

            left: 50%;

            transform: translateX(-50%);

            background: linear-gradient(90deg, var(--accent), #8b5cf6);

            color: white;

            padding: 6px 16px;

            border-radius: 20px;

            font-size: 11px;

            font-weight: 700;

            letter-spacing: 0.5px;

        }

        .tariff-badge {

            display: inline-block;

            padding: 4px 12px;

            border-radius: 20px;

            font-size: 11px;

            font-weight: 600;

            margin-bottom: 12px;

        }

        .tariff-badge.bestseller {

            background: #f59e0b33;

            color: #f59e0b;

        }

        .tariff-badge.economy {

            background: #22c55e33;

            color: #22c55e;

        }

        .tariff-badge.starter {

            background: #8b5cf633;

            color: #a78bfa;

        }

        .tariff-badge.free {

            background: #06b6d433;

            color: #22d3ee;

        }

        .tariff-title {

            font-size: 22px;

            font-weight: 700;

            margin-bottom: 8px;

        }

        .tariff-lessons {

            font-size: 14px;

            color: var(--muted);

            margin-bottom: 16px;

        }

        .tariff-price {

            display: flex;

            align-items: baseline;

            gap: 8px;

            margin-bottom: 8px;

        }

        .tariff-price .amount {

            font-size: 36px;

            font-weight: 800;

            color: #22c55e;

        }

        .tariff-price .per {

            font-size: 14px;

            color: var(--muted);

        }

        .tariff-total {

            font-size: 13px;

            color: var(--muted);

            margin-bottom: 20px;

            padding: 8px 12px;

            background: var(--bg-deep);

            border-radius: 8px;

            display: inline-block;

        }

        .tariff-total strong {

            color: var(--text);

        }

        .tariff-features {

            list-style: none;

            padding: 0;

            margin: 0 0 20px 0;

        }

        .tariff-features li {

            padding: 10px 0;

            border-bottom: 1px solid var(--border);

            display: flex;

            align-items: center;

            gap: 10px;

            font-size: 14px;

            color: var(--muted);

        }

        .tariff-features li:last-child {

            border-bottom: none;

        }

        .tariff-features li::before {

            content: '‚úì';

            color: #22c55e;

            font-weight: bold;

            font-size: 16px;

        }

        .tariff-btn {

            width: 100%;

            padding: 14px;

            border-radius: 12px;

            font-weight: 600;

            font-size: 15px;

            transition: all 0.3s;

        }

        .tariff-card.recommended .tariff-btn {

            background: linear-gradient(90deg, var(--accent), #8b5cf6);

        }

        .tariff-card.free-trial {

            border-style: dashed;

        }

        .tariff-card.free-trial .tariff-price .amount {

            color: #22d3ee;

        }

        .discount-badge {

            background: #ef4444;

            color: white;

            padding: 2px 8px;

            border-radius: 4px;

            font-size: 12px;

            font-weight: 600;

            margin-left: 8px;

        }

        .compare-hint {

            text-align: center;

            margin-top: 24px;

            color: var(--muted);

            font-size: 13px;

        }



        /* Request form */

        .request-form {

            background: var(--bg-deep);

            border: 1px solid var(--border);

            border-radius: 16px;

            padding: 24px;

            margin-top: 32px;

        }

        .request-form h3 {

            margin-top: 0;

        }

    </style>

</head>

<body>

<div class="app">

    <header>

        <div style="display:flex;align-items:center;gap:8px;">

            <div class="burger" id="burger">

                <span></span><span></span><span></span>

            </div>

            <div class="logo">English School</div>

        </div>

        <div>

            <a href="https://t.me/nazardenglish" class="btn btn-telegram" target="_blank">

                –ú—ñ–π Telegram

            </a>

        </div>

    </header>



    <aside class="sidebar" id="sidebar">

        <div class="sidebar-title">–ù–∞–≤—ñ–≥–∞—Ü—ñ—è</div>

        <div class="nav">

            <button class="nav-button active" data-page="home">üè† –ì–æ–ª–æ–≤–Ω–∞</button>

            <button class="nav-button" data-page="courses">üìö –ö—É—Ä—Å–∏</button>

            <button class="nav-button" data-page="tips">üí° –ü—ñ–¥–∫–∞–∑–∫–∏</button>

            <button class="nav-button" data-page="cabinet">üë§ –û—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç</button>

            <button class="nav-button" data-page="chat">üí¨ –ß–∞—Ç –∑ –≤—á–∏—Ç–µ–ª–µ–º</button>

            <button class="nav-button" data-page="admin" id="admin-nav-btn" style="display:none;">‚öôÔ∏è –ê–¥–º—ñ–Ω</button>

        </div>

        <div class="sidebar-small">

            –û–±–µ—Ä–∏ –≤–∫–ª–∞–¥–∫—É, –≤–æ–Ω–∞ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è –ø–æ —Ü–µ–Ω—Ç—Ä—É.<br>

            –ù–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ –º–µ–Ω—é —Ö–æ–≤–∞—î—Ç—å—Å—è –ø—ñ–¥ "—Ç—Ä—å–æ–º–∞ –ø–æ–ª–æ—Å–∫–∞–º–∏".

        </div>

    </aside>



    <div class="overlay" id="overlay"></div>



    <main class="main">

        <!-- –ì–û–õ–û–í–ù–ê -->

        <section class="page page-active" id="page-home">

            <h1>–ü—Ä–∏–≤—ñ—Ç, –º–µ–Ω–µ –∑–≤–∞—Ç–∏ –ù–∞–∑–∞—Ä üëã</h1>

            <p>

                –¶–µ —Å–∞–π—Ç —à–∫–æ–ª–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—ó –º–æ–≤–∏. –¢—É—Ç –º–æ–∂–Ω–∞ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø—Ä–æ –∫—É—Ä—Å–∏, –ø–æ–¥–∏–≤–∏—Ç–∏—Å—è —Ñ–æ—Ç–æ —Ç–∞ –≤—ñ–¥–µ–æ –∑ —É—Ä–æ–∫—ñ–≤,

                –∞ —Ç–∞–∫–æ–∂ –∑–∞–π—Ç–∏ –≤ –æ—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç —É—á–Ω—è.

            </p>



            <a href="#" class="btn btn-primary" onclick="openPage('cabinet');return false;">

                –ü–µ—Ä–µ–π—Ç–∏ –≤ –æ—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç

            </a>



            <h2 style="margin-top:32px;">–ö—É—Ä—Å–∏</h2>

            <div class="cards">

                <div class="card">

                    <span class="tag">A1‚ÄìA2</span>

                    <h3>–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å</h3>

                    <p>–ë–∞–∑–æ–≤–∞ –≥—Ä–∞–º–∞—Ç–∏–∫–∞, –∞–ª—Ñ–∞–≤—ñ—Ç, –ø—Ä–æ—Å—Ç—ñ –¥—ñ–∞–ª–æ–≥–∏, –±–∞–≥–∞—Ç–æ —ñ–≥–æ—Ä —Ç–∞ –∫–∞—Ä—Ç–æ–∫.</p>

                </div>

                <div class="card">

                    <span class="tag">B1‚ÄìB2</span>

                    <h3>–°–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å</h3>

                    <p>–ë—ñ–ª—å—à–µ —Ä–æ–∑–º–æ–≤–Ω–æ—ó –ø—Ä–∞–∫—Ç–∏–∫–∏, –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ —à–∫—ñ–ª—å–Ω–∏—Ö –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏—Ö —Ç–∞ —ñ—Å–ø–∏—Ç—ñ–≤.</p>

                </div>

                <div class="card">

                    <span class="tag">Speaking</span>

                    <h3>–†–æ–∑–º–æ–≤–Ω—ñ –∫–ª—É–±–∏</h3>

                    <p>–û–±–≥–æ–≤–æ—Ä—é—î–º–æ —Ñ—ñ–ª—å–º–∏, –º—É–∑–∏–∫—É, —ñ–≥—Ä–∏ —Ç–∞ —Ä–µ–∞–ª—å–Ω—ñ —Ç–µ–º–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é.</p>

                </div>

            </div>



            <h2 style="margin-top:32px;">–ú–µ–¥—ñ–∞</h2>

            <div class="cards">

                <div class="card">

                    <h3>–§–æ—Ç–æ –∑ —É—Ä–æ–∫—É</h3>

                    <p>–°—é–¥–∏ –º–æ–∂–Ω–∞ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ —Ñ–æ—Ç–æ –∑ –∑–∞–Ω—è—Ç—å.</p>

                    <img src="photo.jpg" alt="–§–æ—Ç–æ —à–∫–æ–ª–∏">

                </div>

                <div class="card">

                    <h3>–í—ñ–¥–µ–æ –∑ –∑–∞–Ω—è—Ç—Ç—è</h3>

                    <p>–¢—É—Ç –º–æ–∂–Ω–∞ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –∫–æ—Ä–æ—Ç–∫–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —É—Ä–æ–∫—É.</p>

                    <video controls>

                        <source src="lesson.mp4" type="video/mp4">

                        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –≤—ñ–¥–µ–æ.

                    </video>

                    <p style="font-size:12px;margin-top:6px;color:#9ca3af;">

                        –ü–æ–∫–ª–∞–¥–∏ —Ñ–∞–π–ª <strong>lesson.mp4</strong> —É —Ç—É –∂ –ø–∞–ø–∫—É, —â–æ –π <strong>index.html</strong>.

                    </p>

                </div>

            </div>

        </section>



        <!-- –ü–Ü–î–ö–ê–ó–ö–ò -->

        <section class="page" id="page-tips">

            <h1>–ü—ñ–¥–∫–∞–∑–∫–∏ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—ó üí°</h1>

            <p>–¢—É—Ç —É—á–Ω—ñ –º–æ–∂—É—Ç—å –ø—ñ–¥–¥–∏–≤–∏—Ç–∏—Å—è –∫–æ—Ä–∏—Å–Ω—ñ –ø–æ—Ä–∞–¥–∏, —è–∫ –ª–µ–≥—à–µ –≤—á–∏—Ç–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫—É.</p>



            <div class="cards">

                <div class="card">

                    <h3>–Ø–∫ –≤—á–∏—Ç–∏ —Å–ª–æ–≤–∞</h3>

                    <ul style="padding-left:18px;color:#9ca3af;">

                        <li>–í—á–∏ –Ω–µ –æ–∫—Ä–µ–º—ñ —Å–ª–æ–≤–∞, –∞ —Ñ—Ä–∞–∑–∏ (<em>have breakfast</em> –∑–∞–º—ñ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ <em>breakfast</em>).</li>

                        <li>–ü–æ–≤—Ç–æ—Ä—é–π –ø–æ 5‚Äì10 —Ö–≤–∏–ª–∏–Ω —â–æ–¥–Ω—è, –∞ –Ω–µ 2 –≥–æ–¥–∏–Ω–∏ —Ä–∞–∑ –Ω–∞ –º—ñ—Å—è—Ü—å.</li>

                        <li>–†–æ–±–∏ —Å–≤–æ—ó —Å–ø–∏—Å–∫–∏ —Å–ª—ñ–≤ –ø–æ —Ç–µ–º–∞—Ö: —à–∫–æ–ª–∞, —ó–∂–∞, –ø–æ–¥–æ—Ä–æ–∂—ñ.</li>

                    </ul>

                </div>

                <div class="card">

                    <h3>–©–æ –¥–∏–≤–∏—Ç–∏—Å—è</h3>

                    <ul style="padding-left:18px;color:#9ca3af;">

                        <li>–ú—É–ª—å—Ç—Ñ—ñ–ª—å–º–∏ –∞–±–æ —Å–µ—Ä—ñ–∞–ª–∏ –∑ –∞–Ω–≥–ª—ñ–π—Å—å–∫–∏–º–∏ —Å—É–±—Ç–∏—Ç—Ä–∞–º–∏.</li>

                        <li>–ö–æ—Ä–æ—Ç–∫—ñ –≤—ñ–¥–µ–æ –Ω–∞ YouTube –¥–ª—è —Ä—ñ–≤–Ω—è A1‚ÄìB1.</li>

                        <li>–°–ø–æ—á–∞—Ç–∫—É —Å–ª—É—Ö–∞–π, –∞ –ø–æ—Ç—ñ–º –≤–∂–µ –ø—ñ–¥–≥–ª—è–¥–∞–π —É –ø–µ—Ä–µ–∫–ª–∞–¥.</li>

                    </ul>

                </div>

                <div class="card">

                    <h3>–Ø–∫ –Ω–µ —Å–æ—Ä–æ–º–∏—Ç–∏—Å—å –≥–æ–≤–æ—Ä–∏—Ç–∏</h3>

                    <ul style="padding-left:18px;color:#9ca3af;">

                        <li>–†–æ–∑–º–æ–≤–ª—è–π —ñ–∑ –æ–¥–Ω–æ–∫–ª–∞—Å–Ω–∏–∫–∞–º–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é —Ö–æ—á–∞ –± 5 —Ö–≤–∏–ª–∏–Ω –Ω–∞ —É—Ä–æ—Ü—ñ.</li>

                        <li>–ù–µ –±—ñ–π—Å—è –ø–æ–º–∏–ª–æ–∫ ‚Äì —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –Ω–∞–≤—á–∞–Ω–Ω—è.</li>

                        <li>–ó–∞–ø–∏—Å—É–π —Å–µ–±–µ –Ω–∞ –≤—ñ–¥–µ–æ –π —Å–ª—É—Ö–∞–π, —è–∫ –∑–≤—É—á–∏—à.</li>

                    </ul>

                </div>

            </div>

        </section>



        <!-- –ö–ê–ë–Ü–ù–ï–¢ -->

        <section class="page" id="page-cabinet">

            <h1>–û—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç —É—á–Ω—è üë§</h1>

            <p>

                –¢—É—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ–π–Ω–∏–π –≤—Ö—ñ–¥ —É –∫–∞–±—ñ–Ω–µ—Ç.<br>

                –î–∞–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –Ω–∞ Firebase (–∞–∫–∞—É–Ω—Ç + –ø—Ä–æ–≥—Ä–µ—Å).

            </p>



            <div class="card" id="login-section">

                <h2 style="margin-top:0;">–í—Ö—ñ–¥ / –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h2>

                <p style="font-size:13px;margin-bottom:10px;">

                    –û–±–µ—Ä—ñ—Ç—å, —á–∏ —Ö–æ—á–µ—Ç–µ —É–≤—ñ–π—Ç–∏ –≤ —ñ—Å–Ω—É—é—á–∏–π –∞–∫–∞—É–Ω—Ç, —á–∏ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π.

                </p>



                <div class="auth-tabs">

                    <button class="auth-tab active" data-tab="login">–í—Ö—ñ–¥</button>

                    <button class="auth-tab" data-tab="register">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</button>

                </div>



                <div id="error" class="error" style="display:none;"></div>

                <div id="success" class="success" style="display:none;"></div>



                <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥—É -->

                <form id="login-form" class="auth-form active">

                    <label for="login-email">Email</label>

                    <input type="email" id="login-email" name="email"

                           placeholder="–í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—é –ø–æ—à—Ç—É" required>



                    <label for="login-password">–ü–∞—Ä–æ–ª—å</label>

                    <input type="password" id="login-password" name="password"

                           placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å" required>



                    <button type="submit" class="btn btn-primary">–£–≤—ñ–π—Ç–∏</button>

                </form>



                <!-- –§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó -->

                <form id="register-form" class="auth-form">

                    <label for="register-firstname">–Ü–º'—è</label>

                    <input type="text" id="register-firstname" name="firstname"

                           placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ —ñ–º'—è" required>



                    <label for="register-lastname">–ü—Ä—ñ–∑–≤–∏—â–µ</label>

                    <input type="text" id="register-lastname" name="lastname"

                           placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –ø—Ä—ñ–∑–≤–∏—â–µ" required>



                    <label for="register-email">Email</label>

                    <input type="email" id="register-email" name="email"

                           placeholder="–í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—é –ø–æ—à—Ç—É" required>



                    <label for="register-password">–ü–∞—Ä–æ–ª—å</label>

                    <input type="password" id="register-password" name="password"

                           placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å (–º—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤)" required minlength="6">



                    <label for="register-password-confirm">–ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å</label>

                    <input type="password" id="register-password-confirm" name="passwordConfirm"

                           placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å —â–µ —Ä–∞–∑" required minlength="6">



                    <button type="submit" class="btn btn-primary">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>

                </form>

            </div>



            <div class="card" id="cabinet-section" style="display:none;margin-top:20px;">

                <h2 style="margin-top:0;">–í—ñ—Ç–∞—é –≤ –∫–∞–±—ñ–Ω–µ—Ç—ñ üëã</h2>

                <p>–í–∏ –∑–∞–π—à–ª–∏ —è–∫: <strong id="user-email"></strong></p>



                <div class="info-row">

                    <div class="info-box">

                        <strong>–í–∞—à —Ä—ñ–≤–µ–Ω—å:</strong><br>

                        <select id="level-select">

                            <option value="A1 ‚Äì Beginner">A1 ‚Äì Beginner</option>

                            <option value="A2 ‚Äì Elementary">A2 ‚Äì Elementary</option>

                            <option value="B1 ‚Äì Intermediate">B1 ‚Äì Intermediate</option>

                            <option value="B2 ‚Äì Upper-Intermediate">B2 ‚Äì Upper-Intermediate</option>

                            <option value="C1 ‚Äì Advanced">C1 ‚Äì Advanced</option>

                        </select>

                    </div>

                    <div class="info-box">

                        <strong>–ì—Ä—É–ø–∞:</strong><br>

                        <input id="group-input" type="text" placeholder="–ù–∞–ø—Ä. Teens Group #3">

                    </div>

                    <div class="info-box">

                        <strong>–†–æ–∑–∫–ª–∞–¥:</strong><br>

                        <input id="schedule-input" type="text" placeholder="–ü–Ω / –°—Ä / –ü—Ç ‚Äì 17:00">

                    </div>

                </div>



                <div class="info-row">

                    <div class="info-box">

                        <strong>–ü—Ä–æ–≥—Ä–µ—Å –ø–æ —É—Ä–æ–∫–∞—Ö:</strong><br>

                        <div style="margin-top:6px;font-size:12px;">

                            –ü—Ä–æ–π–¥–µ–Ω–æ —É—Ä–æ–∫—ñ–≤:

                            <input type="number" id="lessons-done" min="0" value="0" style="width:80px;display:inline-block;">

                            –∑

                            <input type="number" id="lessons-total" min="1" value="20" style="width:80px;display:inline-block;">

                        </div>

                        <div class="progress">

                            <div class="progress-bar" id="lessons-progress-bar"></div>

                        </div>

                        <div class="progress-text" id="lessons-progress-text"></div>

                    </div>



                    <div class="info-box">

                        <strong>–°–ª–æ–≤–∞:</strong><br>

                        <div style="margin-top:6px;font-size:12px;">

                            –í–∏–≤—á–µ–Ω–æ —Å–ª—ñ–≤:

                            <input type="number" id="words-learned" min="0" value="0" style="width:80px;display:inline-block;">

                            –∑ —Ü—ñ–ª—ñ

                            <input type="number" id="words-goal" min="1" value="100" style="width:80px;display:inline-block;">

                        </div>

                        <div class="progress">

                            <div class="progress-bar" id="words-progress-bar"></div>

                        </div>

                        <div class="progress-text" id="words-progress-text"></div>

                    </div>

                </div>



                <div class="info-row">

                    <div class="info-box" style="flex:1 1 100%;">

                        <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–∂–Ω—è—Ö (—Å–∫—ñ–ª—å–∫–∏ —É—Ä–æ–∫—ñ–≤ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ):</strong>

                        <div class="week-form-row">

                            <input type="week" id="week-input">

                            <input type="number" id="week-lessons" min="0" placeholder="–£—Ä–æ–∫—ñ–≤ –∑–∞ —Ç–∏–∂–¥–µ–Ω—å">

                            <button id="add-week-btn" type="button" class="btn btn-outline">–î–æ–¥–∞—Ç–∏ —Ç–∏–∂–¥–µ–Ω—å</button>

                        </div>

                        <ul id="weeks-list" class="weeks-list"></ul>

                    </div>

                </div>



                <button id="logout-btn" class="btn btn-outline" style="margin-top:14px;">

                    –í–∏–π—Ç–∏ –∑ –∞–∫–∞—É–Ω—Ç–∞

                </button>

            </div>



            <!-- –ú–æ—ó –∫—É—Ä—Å–∏ -->

            <div class="card" id="my-courses-section" style="display:none;margin-top:20px;">

                <h2 style="margin-top:0;">üéì –ú–æ—ó –∫—É—Ä—Å–∏</h2>

                <div id="my-courses-list">

                    <p style="color:var(--muted);">–£ –≤–∞—Å –ø–æ–∫–∏ –Ω–µ–º–∞—î –∫—É–ø–ª–µ–Ω–∏—Ö –∫—É—Ä—Å—ñ–≤.</p>

                </div>

                <a href="#" class="btn btn-outline" onclick="openPage('courses');return false;" style="margin-top:12px;">

                    –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ –∫—É—Ä—Å–∏

                </a>

            </div>

        </section>



        <!-- –ß–ê–¢ -->

        <section class="page" id="page-chat">

            <h1>–ß–∞—Ç –∑ –≤—á–∏—Ç–µ–ª–µ–º üí¨</h1>



            <!-- –î–ª—è –≤—á–∏—Ç–µ–ª—è: —Å–ø–∏—Å–æ–∫ —É—á–Ω—ñ–≤ -->

            <div id="teacher-view" style="display:none;">

                <div class="card">

                    <h2 style="margin-top:0;">–°–ø–∏—Å–æ–∫ —É—á–Ω—ñ–≤</h2>

                    <p>–û–±–µ—Ä—ñ—Ç—å —É—á–Ω—è –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:</p>

                    <div id="students-list" style="margin-top:16px;"></div>

                </div>



                <div class="card" id="teacher-chat-section" style="display:none;margin-top:20px;">

                    <h2 style="margin-top:0;">–ß–∞—Ç –∑ <span id="selected-student-name"></span></h2>

                    <div id="teacher-messages" style="max-height:400px;overflow-y:auto;margin-bottom:16px;padding:12px;background:var(--bg-deep);border-radius:10px;border:1px solid var(--border);"></div>

                    <div style="display:flex;gap:8px;">

                        <input type="text" id="teacher-message-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..." style="flex:1;margin-bottom:0;">

                        <button id="teacher-send-btn" class="btn btn-primary">–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏</button>

                    </div>

                    <button id="back-to-students" class="btn btn-outline" style="margin-top:12px;">–ù–∞–∑–∞–¥ –¥–æ —Å–ø–∏—Å–∫—É</button>

                </div>

            </div>



            <!-- –î–ª—è —É—á–Ω—è: —á–∞—Ç –∑ –≤—á–∏—Ç–µ–ª–µ–º -->

            <div id="student-view" style="display:none;">

                <div class="card">

                    <h2 style="margin-top:0;">–í–∞—à—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</h2>

                    <div id="student-messages" style="max-height:400px;overflow-y:auto;margin-bottom:16px;padding:12px;background:var(--bg-deep);border-radius:10px;border:1px solid var(--border);"></div>

                    <div style="display:flex;gap:8px;">

                        <input type="text" id="student-message-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..." style="flex:1;margin-bottom:0;">

                        <button id="student-send-btn" class="btn btn-primary">–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏</button>

                    </div>

                </div>

            </div>



            <!-- –Ø–∫—â–æ –Ω–µ –∑–∞–ª–æ–≥—ñ–Ω–µ–Ω–∏–π -->

            <div id="chat-login-prompt" class="card">

                <p>–î–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —á–∞—Ç—É –ø–æ—Ç—Ä—ñ–±–Ω–æ —É–≤—ñ–π—Ç–∏ –≤ –∞–∫–∞—É–Ω—Ç.</p>

                <a href="#" class="btn btn-primary" onclick="openPage('cabinet');return false;">–£–≤—ñ–π—Ç–∏</a>

            </div>

        </section>



        <!-- –¢–ê–†–ò–§–ò -->

        <section class="page" id="page-courses">

            <h1>–¢–∞—Ä–∏—Ñ–∏ –Ω–∞ –Ω–∞–≤—á–∞–Ω–Ω—è üìö</h1>

            <p>–û–±–µ—Ä–∏ —Å–≤—ñ–π —Ç–∞—Ä–∏—Ñ —ñ –ø–æ—á–Ω–∏ –≤–∏–≤—á–∞—Ç–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫—É –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!</p>



            <div class="tariffs-grid">

                <!-- –ü—Ä–æ–±–Ω–∏–π —É—Ä–æ–∫ -->

                <div class="tariff-card free-trial" id="tariff-trial-card">

                    <span class="tariff-badge free">üéÅ –ë–ï–ó–ö–û–®–¢–û–í–ù–û</span>

                    <h3 class="tariff-title">–ü—Ä–æ–±–Ω–∏–π —É—Ä–æ–∫</h3>

                    <p class="tariff-lessons">30‚Äì50 —Ö–≤–∏–ª–∏–Ω –∑–Ω–∞–π–æ–º—Å—Ç–≤–∞</p>

                    <div class="tariff-price">

                        <span class="amount">0‚Ç¨</span>

                    </div>

                    <div class="tariff-total">–ë–µ–∑ –∑–æ–±–æ–≤'—è–∑–∞–Ω—å</div>

                    <ul class="tariff-features">

                        <li>–ó–Ω–∞–π–æ–º—Å—Ç–≤–æ –∑ –≤–∏–∫–ª–∞–¥–∞—á–µ–º</li>

                        <li>–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≤–∞—à–æ–≥–æ —Ä—ñ–≤–Ω—è</li>

                        <li>–ú—ñ–Ω—ñ-–¥–µ–º–æ –∑–∞–Ω—è—Ç—Ç—è</li>

                        <li>–í—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –≤—Å—ñ –ø–∏—Ç–∞–Ω–Ω—è</li>

                    </ul>

                    <button class="btn btn-outline tariff-btn" onclick="openTariffModal('trial', '–ü—Ä–æ–±–Ω–∏–π —É—Ä–æ–∫', 0, 1)">

                        –ó–∞–ø–∏—Å–∞—Ç–∏—Å—å –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ

                    </button>

                </div>



                <!-- 8 –∑–∞–Ω—è—Ç—å -->

                <div class="tariff-card" id="tariff-8-card">

                    <span class="tariff-badge starter">üöÄ –î–õ–Ø –°–¢–ê–†–¢–£</span>

                    <h3 class="tariff-title">8 –∑–∞–Ω—è—Ç—å</h3>

                    <p class="tariff-lessons">~2 –º—ñ—Å—è—Ü—ñ –Ω–∞–≤—á–∞–Ω–Ω—è</p>

                    <div class="tariff-price">

                        <span class="amount">10‚Ç¨</span>

                        <span class="per">/ —É—Ä–æ–∫</span>

                    </div>

                    <div class="tariff-total">–ó–∞–≥–∞–ª–æ–º: <strong>80‚Ç¨</strong></div>

                    <ul class="tariff-features">

                        <li>–î–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—ó –¥–æ—à–∫–∏</li>

                        <li>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 24/7</li>

                        <li>–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥</li>

                    </ul>

                    <button class="btn btn-primary tariff-btn" onclick="openTariffModal('lessons8', '8 –∑–∞–Ω—è—Ç—å', 80, 8)">

                        –û–±—Ä–∞—Ç–∏ —Ç–∞—Ä–∏—Ñ

                    </button>

                </div>



                <!-- 16 –∑–∞–Ω—è—Ç—å -->

                <div class="tariff-card" id="tariff-16-card">

                    <span class="tariff-badge bestseller">üî• –ë–ï–°–¢–°–ï–õ–ï–†</span>

                    <h3 class="tariff-title">16 –∑–∞–Ω—è—Ç—å</h3>

                    <p class="tariff-lessons">~4 –º—ñ—Å—è—Ü—ñ –Ω–∞–≤—á–∞–Ω–Ω—è</p>

                    <div class="tariff-price">

                        <span class="amount">11‚Ç¨</span>

                        <span class="per">/ —É—Ä–æ–∫</span>

                    </div>

                    <div class="tariff-total">–ó–∞–≥–∞–ª–æ–º: <strong>176‚Ç¨</strong></div>

                    <ul class="tariff-features">

                        <li>PDF ¬´100 —Ä–æ–∑–º–æ–≤–Ω–∏—Ö —Ñ—Ä–∞–∑¬ª</li>

                        <li>–î–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—ó –¥–æ—à–∫–∏</li>

                        <li>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 24/7</li>

                        <li>–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥</li>

                    </ul>

                    <button class="btn btn-primary tariff-btn" onclick="openTariffModal('lessons16', '16 –∑–∞–Ω—è—Ç—å', 176, 16)">

                        –û–±—Ä–∞—Ç–∏ —Ç–∞—Ä–∏—Ñ

                    </button>

                </div>



                <!-- 32 –∑–∞–Ω—è—Ç—Ç—è - –†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–û -->

                <div class="tariff-card recommended" id="tariff-32-card">

                    <span class="tariff-badge economy">üí∞ –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê –ï–ö–û–ù–û–ú–Ü–Ø</span>

                    <h3 class="tariff-title">32 –∑–∞–Ω—è—Ç—Ç—è</h3>

                    <p class="tariff-lessons">~8 –º—ñ—Å—è—Ü—ñ–≤ –Ω–∞–≤—á–∞–Ω–Ω—è</p>

                    <div class="tariff-price">

                        <span class="amount">10‚Ç¨</span>

                        <span class="per">/ —É—Ä–æ–∫</span>

                        <span class="discount-badge">-9%</span>

                    </div>

                    <div class="tariff-total">–ó–∞–≥–∞–ª–æ–º: <strong>320‚Ç¨</strong> <s style="color:var(--muted);font-size:12px;">352‚Ç¨</s></div>

                    <ul class="tariff-features">

                        <li>üéâ –°–ø—ñ–∫—ñ–Ω–≥-–∫–ª–∞–±–∏ 1 —Ä–∞–∑/2 –º—ñ—Å—è—Ü—ñ</li>

                        <li>PDF ¬´100 —Ä–æ–∑–º–æ–≤–Ω–∏—Ö —Ñ—Ä–∞–∑¬ª</li>

                        <li>–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ —Ç–∞ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –¥–æ—à–∫–∞</li>

                        <li>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 24/7</li>

                        <li>–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥</li>

                    </ul>

                    <button class="btn btn-primary tariff-btn" onclick="openTariffModal('lessons32', '32 –∑–∞–Ω—è—Ç—Ç—è', 320, 32)">

                        –û–±—Ä–∞—Ç–∏ —Ç–∞—Ä–∏—Ñ

                    </button>

                </div>

            </div>



            <p class="compare-hint">üí° –ü–æ—Ä–∞–¥–∞: —á–∏–º –±—ñ–ª—å—à–µ –∑–∞–Ω—è—Ç—å ‚Äî —Ç–∏–º –≤–∏–≥—ñ–¥–Ω—ñ—à–∞ —Ü—ñ–Ω–∞ –∑–∞ —É—Ä–æ–∫!</p>



            <!-- –§–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏ –±–µ–∑ —Ç–∞—Ä–∏—Ñ—É -->

            <div class="request-form">

                <h3>üìù –ù–µ –≤–ø–µ–≤–Ω–µ–Ω—ñ —è–∫–∏–π —Ç–∞—Ä–∏—Ñ –æ–±—Ä–∞—Ç–∏?</h3>

                <p style="color:var(--muted);margin-bottom:16px;">–ó–∞–ª–∏—à—Ç–µ –∑–∞—è–≤–∫—É —ñ —è –¥–æ–ø–æ–º–æ–∂—É –ø—ñ–¥—ñ–±—Ä–∞—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è –≤–∞—Å!</p>

                <div style="display:flex;gap:12px;flex-wrap:wrap;">

                    <input type="text" id="request-name" placeholder="–í–∞—à–µ —ñ–º'—è" style="flex:1;min-width:200px;">

                    <input type="text" id="request-contact" placeholder="Telegram –∞–±–æ —Ç–µ–ª–µ—Ñ–æ–Ω" style="flex:1;min-width:200px;">

                    <button class="btn btn-primary" onclick="sendGeneralRequest()">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞—è–≤–∫—É</button>

                </div>

                <div id="request-status" style="margin-top:12px;"></div>

            </div>



            <div id="courses-login-prompt" class="card" style="margin-top:24px;display:none;">

                <p>‚ö†Ô∏è –î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è —Ç–∞—Ä–∏—Ñ—É —É–≤—ñ–π–¥—ñ—Ç—å –≤ –∞–∫–∞—É–Ω—Ç –∞–±–æ –∑–∞–ª–∏—à—Ç–µ –∑–∞—è–≤–∫—É –≤–∏—â–µ</p>

                <a href="#" class="btn btn-primary" onclick="openPage('cabinet');return false;">–£–≤—ñ–π—Ç–∏ / –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å</a>

            </div>

        </section>



        <!-- –ê–î–ú–Ü–ù –ü–ê–ù–ï–õ–¨ -->

        <section class="page" id="page-admin">

            <h1>–ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å ‚öôÔ∏è</h1>

            <p>–¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É–≤–∞—Ç–∏ –æ–ø–ª–∞—Ç–∏ —Ç–∞ –∫–µ—Ä—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø–æ–º –¥–æ –∫—É—Ä—Å—ñ–≤.</p>



            <div class="card" style="margin-top:20px;">

                <h2 style="margin-top:0;">–ó–∞—è–≤–∫–∏ –Ω–∞ –æ–ø–ª–∞—Ç—É</h2>

                <div id="pending-purchases">

                    <p style="color:var(--muted);">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>

                </div>

            </div>



            <div class="card" style="margin-top:20px;">

                <h2 style="margin-top:0;">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω—ñ –ø–æ–∫—É–ø–∫–∏</h2>

                <div id="approved-purchases">

                    <p style="color:var(--muted);">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>

                </div>

            </div>



            <div class="card" style="margin-top:20px;">

                <h2 style="margin-top:0;">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫—É—Ä—Å—ñ–≤</h2>

                <p style="font-size:13px;color:var(--muted);">–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—ñ–≤ (—É—á–Ω—ñ –ø–æ–±–∞—á–∞—Ç—å —ó—Ö –ø—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –æ–ø–ª–∞—Ç–∏)</p>

                

                <label style="margin-top:12px;">–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∫—É—Ä—Å:</label>

                <input type="text" id="beginner-course-link" placeholder="https://..." value="">

                

                <label>–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∏–π –∫—É—Ä—Å:</label>

                <input type="text" id="advanced-course-link" placeholder="https://..." value="">

                

                <button class="btn btn-primary" onclick="saveCourseLinks()" style="margin-top:8px;">–ó–±–µ—Ä–µ–≥—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</button>

            </div>

        </section>



    </main>



    <!-- –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –û–ü–õ–ê–¢–ò -->

    <div class="modal" id="purchase-modal">

        <div class="modal-content">

            <div class="modal-header">

                <h2 id="modal-course-name">–ö—É–ø–∏—Ç–∏ –∫—É—Ä—Å</h2>

                <button class="modal-close" onclick="closePurchaseModal()">&times;</button>

            </div>

            

            <div class="payment-card">

                <p style="margin:0;color:var(--muted);font-size:13px;">–ü–µ—Ä–µ–∫–∞–∑ –Ω–∞ –∫–∞—Ä—Ç–∫—É Monobank</p>

                <div class="payment-card-number" id="payment-card-display">4441 1144 6530 0463</div>

                <button class="copy-btn" onclick="copyCardNumber()">üìã –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–æ–º–µ—Ä</button>

            </div>

            

            <div style="text-align:center;margin:16px 0;">

                <div class="course-price" id="modal-price">10 ‚Ç¥</div>

                <p style="margin:4px 0;color:var(--muted);font-size:13px;">–°—É–º–∞ –¥–æ –æ–ø–ª–∞—Ç–∏</p>

            </div>

            

            <ol class="payment-steps">

                <li>–í—ñ–¥–∫—Ä–∏–π—Ç–µ <strong>Monobank</strong> –∞–±–æ —ñ–Ω—à–∏–π –±–∞–Ω–∫</li>

                <li>–ó—Ä–æ–±—ñ—Ç—å –ø–µ—Ä–µ–∫–∞–∑ –Ω–∞ –∫–∞—Ä—Ç–∫—É –≤–∏—â–µ</li>

                <li>–í–∫–∞–∂—ñ—Ç—å —Å—É–º—É: <strong id="modal-price-text">10 –≥—Ä–Ω</strong></li>

                <li>–í –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –Ω–∞–ø–∏—à—ñ—Ç—å: <strong id="modal-comment">–≤–∞—à email</strong></li>

                <li>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É "–Ø –æ–ø–ª–∞—Ç–∏–≤" –Ω–∏–∂—á–µ</li>

            </ol>

            

            <div style="display:flex;flex-direction:column;gap:10px;margin-top:20px;">

                <a href="monobank://send?to=4441114465300463" class="btn btn-monobank" style="text-align:center;justify-content:center;">

                    üì± –í—ñ–¥–∫—Ä–∏—Ç–∏ Monobank (–Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ)

                </a>

                <p style="margin:0;text-align:center;font-size:12px;color:var(--muted);">

                    –ê–±–æ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –±–∞–Ω–∫ –≤—Ä—É—á–Ω—É —ñ –∑—Ä–æ–±—ñ—Ç—å –ø–µ—Ä–µ–∫–∞–∑ –Ω–∞ –∫–∞—Ä—Ç–∫—É –≤–∏—â–µ

                </p>

                <button class="btn btn-success" onclick="confirmPayment()" style="padding:14px;">

                    ‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–≤ ‚Äî –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞—è–≤–∫—É

                </button>

                <button class="btn btn-outline" onclick="closePurchaseModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>

            </div>

        </div>

    </div>

</div>



<!-- –ß–ê–¢ –í–Ü–î–ñ–ï–¢ -->

<div class="chat-widget" id="chat-widget">

    <div class="chat-box" id="chat-box">

        <div class="chat-header">

            <div>

                <h3>üí¨ –ß–∞—Ç –∑ –≤–∏–∫–ª–∞–¥–∞—á–µ–º</h3>

                <div class="online">–û–Ω–ª–∞–π–Ω</div>

            </div>

            <button class="chat-close" onclick="toggleChat()">√ó</button>

        </div>

        <div class="chat-messages" id="widget-messages">

            <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥—É—Ç—å —Ç—É—Ç -->

        </div>

        <div id="widget-login-msg" class="chat-login-msg" style="display:none;">

            <p>–£–≤—ñ–π–¥—ñ—Ç—å —â–æ–± –Ω–∞–ø–∏—Å–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</p>

            <a href="#" class="btn btn-primary btn-sm" onclick="openPage('cabinet');toggleChat();return false;">–£–≤—ñ–π—Ç–∏</a>

        </div>

        <div class="chat-input-area" id="widget-input-area">

            <input type="text" id="widget-message-input" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...">

            <button onclick="sendWidgetMessage()">

                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">

                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>

                </svg>

            </button>

        </div>

    </div>

    <button class="chat-toggle" onclick="toggleChat()">

        <svg viewBox="0 0 24 24">

            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>

        </svg>

        <span class="badge" id="chat-badge" style="display:none;">0</span>

    </button>

</div>



<!-- –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –¢–ê–†–ò–§–£ -->

<div class="modal" id="tariff-modal">

    <div class="modal-content">

        <div class="modal-header">

            <h2 id="tariff-modal-title">–ó–∞–ø–∏—Å–∞—Ç–∏—Å—å –Ω–∞ –∫—É—Ä—Å</h2>

            <button class="modal-close" onclick="closeTariffModal()">√ó</button>

        </div>

        

        <div style="text-align:center;margin-bottom:20px;">

            <div class="course-price" id="tariff-modal-price" style="color:var(--accent);">32 –∑–∞–Ω—è—Ç—Ç—è</div>

            <p style="margin:4px 0;color:var(--muted);font-size:14px;" id="tariff-modal-lessons">–ê–±–æ–Ω–µ–º–µ–Ω—Ç</p>

        </div>

        

        <div style="background:var(--bg-deep);border-radius:12px;padding:16px;margin-bottom:20px;">

            <p style="margin:0;text-align:center;color:var(--text);">

                üìû <strong>–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–≤'—è–∂–µ—Ç—å—Å—è –∑ –≤–∞–º–∏</strong> –ø—Ä–æ—Ç—è–≥–æ–º 24 –≥–æ–¥–∏–Ω

            </p>

            <p style="margin:8px 0 0;text-align:center;color:var(--muted);font-size:13px;">

                –û–±–≥–æ–≤–æ—Ä–∏–º–æ –¥–µ—Ç–∞–ª—ñ —Ç–∞ –æ–ø–ª–∞—Ç—É –Ω–∞ –ø–µ—Ä—à–æ–º—É –∑–∞–Ω—è—Ç—Ç—ñ

            </p>

        </div>

        

        <div style="margin-bottom:12px;">

            <label>–í–∞—à–µ —ñ–º'—è:</label>

            <input type="text" id="tariff-name" placeholder="–Ø–∫ –≤–∞—Å –∑–≤–∞—Ç–∏?">

        </div>

        

        <div style="margin-bottom:12px;">

            <label>Telegram –∞–±–æ —Ç–µ–ª–µ—Ñ–æ–Ω:</label>

            <input type="text" id="tariff-contact" placeholder="@username –∞–±–æ +380...">

        </div>

        

        <div style="display:flex;flex-direction:column;gap:10px;margin-top:20px;">

            <button class="btn btn-success" onclick="submitTariffRequest()" style="padding:14px;">

                üì© –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞—è–≤–∫—É

            </button>

            <button class="btn btn-outline" onclick="closeTariffModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>

        </div>

    </div>

</div>



<footer>

    ¬© <span id="year"></span> English School. –ó—Ä–æ–±–ª–µ–Ω–æ –ù–∞–∑–∞—Ä–æ–º.

</footer>



<!-- Firebase SDK —á–µ—Ä–µ–∑ CDN (compat) -->

<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script>

<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth-compat.js"></script>

<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-database-compat.js"></script>



<script>

  const firebaseConfig = {

    apiKey: "AIzaSyCx9TCFKNHyjFSOasZETUFIPdv7xt7kD6s",

    authDomain: "project-6159663906776517660.firebaseapp.com",

    databaseURL: "https://project-6159663906776517660-default-rtdb.firebaseio.com",

    projectId: "project-6159663906776517660",

    storageBucket: "project-6159663906776517660.firebasestorage.app",

    messagingSenderId: "393177783460",

    appId: "1:393177783460:web:8e1c38fdb1392ad7819a31",

    measurementId: "G-HHNPZXF359"

  };



  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();

  const db = firebase.database();

</script>



<script>

    document.getElementById("year").textContent = new Date().getFullYear();



    const burger = document.getElementById("burger");

    const sidebar = document.getElementById("sidebar");

    const overlay = document.getElementById("overlay");

    const navButtons = document.querySelectorAll(".nav-button");



    function openSidebar() {

        sidebar.classList.add("open");

        overlay.classList.add("show");

    }

    function closeSidebar() {

        sidebar.classList.remove("open");

        overlay.classList.remove("show");

    }

    if (burger) burger.addEventListener("click", openSidebar);

    if (overlay) overlay.addEventListener("click", closeSidebar);



    function openPage(pageName) {

        navButtons.forEach(btn => {

            btn.classList.toggle("active", btn.dataset.page === pageName);

        });

        document.querySelectorAll(".page").forEach(page => {

            page.classList.remove("page-active");

        });

        const target = document.getElementById("page-" + pageName);

        if (target) target.classList.add("page-active");

        closeSidebar();

        

        // –Ø–∫—â–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è —á–∞—Ç, –ø–æ–∫–∞–∑—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π view

        if (pageName === "chat") {

            showChatView();

        }

    }

    navButtons.forEach(btn => {

        btn.addEventListener("click", () => openPage(btn.dataset.page));

    });



    // –ü–µ—Ä–µ–º–∏–∫–∞—á –º—ñ–∂ —Ñ–æ—Ä–º–∞–º–∏ –≤—Ö–æ–¥—É —Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó

    const authTabs = document.querySelectorAll(".auth-tab");

    const loginForm = document.getElementById("login-form");

    const registerForm = document.getElementById("register-form");



    authTabs.forEach(tab => {

        tab.addEventListener("click", () => {

            const tabType = tab.dataset.tab;

            authTabs.forEach(t => t.classList.remove("active"));

            tab.classList.add("active");



            loginForm.classList.toggle("active", tabType === "login");

            registerForm.classList.toggle("active", tabType === "register");



            document.getElementById("error").style.display = "none";

            document.getElementById("success").style.display = "none";

        });

    });



    const loginSection = document.getElementById("login-section");

    const cabinetSection = document.getElementById("cabinet-section");

    const userEmailSpan = document.getElementById("user-email");

    const errorBox = document.getElementById("error");

    const successBox = document.getElementById("success");

    const logoutBtn = document.getElementById("logout-btn");



    const levelSelect = document.getElementById("level-select");

    const groupInput = document.getElementById("group-input");

    const scheduleInput = document.getElementById("schedule-input");



    const lessonsDoneInput = document.getElementById("lessons-done");

    const lessonsTotalInput = document.getElementById("lessons-total");

    const lessonsProgressBar = document.getElementById("lessons-progress-bar");

    const lessonsProgressText = document.getElementById("lessons-progress-text");



    const wordsLearnedInput = document.getElementById("words-learned");

    const wordsGoalInput = document.getElementById("words-goal");

    const wordsProgressBar = document.getElementById("words-progress-bar");

    const wordsProgressText = document.getElementById("words-progress-text");



    const weekInput = document.getElementById("week-input");

    const weekLessonsInput = document.getElementById("week-lessons");

    const addWeekBtn = document.getElementById("add-week-btn");

    const weeksList = document.getElementById("weeks-list");



    let currentUser = null;

    let currentProfile = null;



    function defaultProfile() {

        return {

            firstname: "",

            lastname: "",

            level: "A2 ‚Äì Elementary",

            group: "Teens Group #3",

            schedule: "–ü–Ω / –°—Ä / –ü—Ç ‚Äì 17:00",

            lessonsDone: 12,

            lessonsTotal: 20,

            wordsLearned: 0,

            wordsGoal: 100,

            weeks: []

        };

    }



    async function loadProfile(uid) {

        try {

            const snap = await db.ref("profiles/" + uid).get();

            if (!snap.exists()) {

                const prof = defaultProfile();

                await db.ref("profiles/" + uid).set(prof);

                return prof;

            }

            return snap.val();

        } catch (e) {

            console.error("loadProfile error", e);

            return defaultProfile();

        }

    }



    function saveProfile() {

        if (!currentUser || !currentProfile) return;

        db.ref("profiles/" + currentUser.uid).set(currentProfile).catch(console.error);

    }



    function updateLessonsProgress() {

        const done = Math.max(0, Number(currentProfile.lessonsDone) || 0);

        const total = Math.max(1, Number(currentProfile.lessonsTotal) || 1);

        const percent = Math.min(100, Math.round(done / total * 100));

        lessonsProgressBar.style.width = percent + "%";

        lessonsProgressText.textContent = `${done} –∑ ${total} —É—Ä–æ–∫—ñ–≤ (${percent}%)`;

    }



    function updateWordsProgress() {

        const learned = Math.max(0, Number(currentProfile.wordsLearned) || 0);

        const goal = Math.max(1, Number(currentProfile.wordsGoal) || 1);

        const percent = Math.min(100, Math.round(learned / goal * 100));

        wordsProgressBar.style.width = percent + "%";

        wordsProgressText.textContent = `${learned} / ${goal} —Å–ª—ñ–≤ (${percent}%)`;

    }



    function renderWeeks() {

        weeksList.innerHTML = "";

        if (!currentProfile.weeks || currentProfile.weeks.length === 0) {

            const li = document.createElement("li");

            li.textContent = "–©–µ –Ω–µ–º–∞—î –∑–∞–ø–∏—Å—ñ–≤ –ø–æ —Ç–∏–∂–Ω—è—Ö.";

            weeksList.appendChild(li);

            return;

        }

        currentProfile.weeks.forEach(item => {

            const li = document.createElement("li");

            const label = item.week || "–ë–µ–∑ –¥–∞—Ç–∏";

            li.textContent = `${label}: ${item.lessons} —É—Ä–æ–∫—ñ–≤`;

            weeksList.appendChild(li);

        });

    }



    function applyProfileToUI() {

        if (!currentProfile) return;

        levelSelect.value = currentProfile.level || "A2 ‚Äì Elementary";

        groupInput.value = currentProfile.group || "";

        scheduleInput.value = currentProfile.schedule || "";



        lessonsDoneInput.value = currentProfile.lessonsDone ?? 0;

        lessonsTotalInput.value = currentProfile.lessonsTotal ?? 20;

        wordsLearnedInput.value = currentProfile.wordsLearned ?? 0;

        wordsGoalInput.value = currentProfile.wordsGoal ?? 100;



        updateLessonsProgress();

        updateWordsProgress();

        renderWeeks();

    }



    async function showCabinet(user) {

        currentUser = user;

        userEmailSpan.textContent = user.email;

        loginSection.style.display = "none";

        cabinetSection.style.display = "block";

        currentProfile = await loadProfile(user.uid);

        applyProfileToUI();

    }



    function showLogin() {

        currentUser = null;

        currentProfile = null;

        loginSection.style.display = "block";

        cabinetSection.style.display = "none";

        errorBox.style.display = "none";

        successBox.style.display = "none";

    }



    auth.onAuthStateChanged(async (user) => {

        if (user) {

            errorBox.style.display = "none";

            await showCabinet(user);

            

            // –Ø–∫—â–æ –≤—ñ–¥–∫—Ä–∏—Ç–∞ –≤–∫–ª–∞–¥–∫–∞ —á–∞—Ç—É, –æ–Ω–æ–≤–ª—é—î–º–æ —ó—ó

            if (document.getElementById("page-chat")?.classList.contains("page-active")) {

                showChatView();

            }

        } else {

            showLogin();

            

            // –ó—É–ø–∏–Ω—è—î–º–æ listener —á–∞—Ç—É –ø—Ä–∏ –≤–∏—Ö–æ–¥—ñ

            if (chatListener) {

                const chatPath = selectedStudentId 

                    ? `chats/${selectedStudentId}` 

                    : (currentUser ? `chats/${currentUser.uid}` : null);

                if (chatPath) db.ref(chatPath).off("value", chatListener);

                chatListener = null;

                selectedStudentId = null;

            }

        }

    });



    // –û–±—Ä–æ–±–∫–∞ —Ñ–æ—Ä–º–∏ –≤—Ö–æ–¥—É

    if (loginForm) {

        loginForm.addEventListener("submit", async function (e) {

            e.preventDefault();

            const email = document.getElementById("login-email").value.trim();

            const password = document.getElementById("login-password").value.trim();



            errorBox.style.display = "none";

            successBox.style.display = "none";



            try {

                const userCredential = await auth.signInWithEmailAndPassword(email, password);

                errorBox.style.display = "none";

                await showCabinet(userCredential.user);

            } catch (err) {

                console.error(err);

                let errorMessage = "–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É: ";

                if (err.code === "auth/user-not-found") {

                    errorMessage += "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —Ç–∞–∫–∏–º email –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è —Å–ø–æ—á–∞—Ç–∫—É.";

                } else if (err.code === "auth/wrong-password") {

                    errorMessage += "–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å.";

                } else if (err.code === "auth/invalid-email") {

                    errorMessage += "–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç email.";

                } else {

                    errorMessage += err.message || "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞.";

                }

                errorBox.textContent = errorMessage;

                errorBox.style.display = "block";

            }

        });

    }



    // –û–±—Ä–æ–±–∫–∞ —Ñ–æ—Ä–º–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó

    if (registerForm) {

        registerForm.addEventListener("submit", async function (e) {

            e.preventDefault();

            const firstname = document.getElementById("register-firstname").value.trim();

            const lastname = document.getElementById("register-lastname").value.trim();

            const email = document.getElementById("register-email").value.trim();

            const password = document.getElementById("register-password").value.trim();

            const passwordConfirm = document.getElementById("register-password-confirm").value.trim();



            errorBox.style.display = "none";

            successBox.style.display = "none";



            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–æ–ª—ñ–≤

            if (password !== passwordConfirm) {

                errorBox.textContent = "–ü–∞—Ä–æ–ª—ñ –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å!";

                errorBox.style.display = "block";

                return;

            }

            if (password.length < 6) {

                errorBox.textContent = "–ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ –º—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤!";

                errorBox.style.display = "block";

                return;

            }



            try {

                const userCredential = await auth.createUserWithEmailAndPassword(email, password);

                

                // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —ñ–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ –≤ –ø—Ä–æ—Ñ—ñ–ª—å

                const profile = defaultProfile();

                profile.firstname = firstname;

                profile.lastname = lastname;

                profile.email = email;

                await db.ref("profiles/" + userCredential.user.uid).set(profile);

                

                successBox.textContent = "–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞! –í—ñ—Ç–∞—î–º–æ!";

                successBox.style.display = "block";

                await showCabinet(userCredential.user);

            } catch (err) {

                console.error(err);

                let errorMessage = "–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó: ";

                if (err.code === "auth/email-already-in-use") {

                    errorMessage += "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–∞–∫–∏–º email –≤–∂–µ —ñ—Å–Ω—É—î. –°–ø—Ä–æ–±—É–π—Ç–µ —É–≤—ñ–π—Ç–∏.";

                } else if (err.code === "auth/invalid-email") {

                    errorMessage += "–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç email.";

                } else if (err.code === "auth/weak-password") {

                    errorMessage += "–ü–∞—Ä–æ–ª—å –∑–∞–Ω–∞–¥—Ç–æ —Å–ª–∞–±–∫–∏–π. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –º—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤.";

                } else {

                    errorMessage += err.message || "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞.";

                }

                errorBox.textContent = errorMessage;

                errorBox.style.display = "block";

            }

        });

    }



    if (logoutBtn) {

        logoutBtn.addEventListener("click", function () {

            auth.signOut().catch(console.error);

        });

    }



    levelSelect.addEventListener("change", () => {

        if (!currentProfile) return;

        currentProfile.level = levelSelect.value;

        saveProfile();

    });

    groupInput.addEventListener("input", () => {

        if (!currentProfile) return;

        currentProfile.group = groupInput.value;

        saveProfile();

    });

    scheduleInput.addEventListener("input", () => {

        if (!currentProfile) return;

        currentProfile.schedule = scheduleInput.value;

        saveProfile();

    });



    lessonsDoneInput.addEventListener("input", () => {

        if (!currentProfile) return;

        currentProfile.lessonsDone = Number(lessonsDoneInput.value) || 0;

        updateLessonsProgress();

        saveProfile();

    });

    lessonsTotalInput.addEventListener("input", () => {

        if (!currentProfile) return;

        currentProfile.lessonsTotal = Number(lessonsTotalInput.value) || 1;

        updateLessonsProgress();

        saveProfile();

    });



    wordsLearnedInput.addEventListener("input", () => {

        if (!currentProfile) return;

        currentProfile.wordsLearned = Number(wordsLearnedInput.value) || 0;

        updateWordsProgress();

        saveProfile();

    });

    wordsGoalInput.addEventListener("input", () => {

        if (!currentProfile) return;

        currentProfile.wordsGoal = Number(wordsGoalInput.value) || 1;

        updateWordsProgress();

        saveProfile();

    });



    addWeekBtn.addEventListener("click", () => {

        if (!currentProfile) return;

        const week = weekInput.value || "–¢–∏–∂–¥–µ–Ω—å –±–µ–∑ –¥–∞—Ç–∏";

        const lessons = Number(weekLessonsInput.value);

        if (isNaN(lessons) || lessons < 0) return;

        if (!currentProfile.weeks) currentProfile.weeks = [];

        currentProfile.weeks.push({ week, lessons });

        weekLessonsInput.value = "";

        renderWeeks();

        saveProfile();

    });



    // ========== –ß–ê–¢ ==========

    // Email –≤—á–∏—Ç–µ–ª—è - –ó–ú–Ü–ù–Ü–¢–¨ –ù–ê –°–í–Ü–ô EMAIL!

    const TEACHER_EMAIL = "teacher@school.com"; // <-- –ó–ú–Ü–ù–Ü–¢–¨ –¶–ï –ù–ê –°–í–Ü–ô EMAIL!



    let selectedStudentId = null;

    let chatListener = null;



    function isTeacher(user) {

        return user && user.email === TEACHER_EMAIL;

    }



    async function loadStudentsList() {

        try {

            const snap = await db.ref("profiles").get();

            const studentsList = document.getElementById("students-list");

            studentsList.innerHTML = "";

            

            if (!snap.exists()) {

                studentsList.innerHTML = "<p>–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏—Ö —É—á–Ω—ñ–≤.</p>";

                return;

            }

            

            const profiles = snap.val();

            const students = [];

            

            for (const uid in profiles) {

                const profile = profiles[uid];

                if (profile.firstname && profile.lastname) {

                    students.push({

                        uid: uid,

                        firstname: profile.firstname || "",

                        lastname: profile.lastname || "",

                        email: profile.email || ""

                    });

                }

            }

            

            if (students.length === 0) {

                studentsList.innerHTML = "<p>–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏—Ö —É—á–Ω—ñ–≤.</p>";

                return;

            }

            

            students.forEach(student => {

                const div = document.createElement("div");

                div.className = "student-item";

                div.textContent = `${student.firstname} ${student.lastname} (${student.email})`;

                div.onclick = () => selectStudent(student.uid, student.firstname, student.lastname);

                studentsList.appendChild(div);

            });

            

        } catch (e) {

            console.error("loadStudentsList error", e);

        }

    }



    function selectStudent(uid, firstname, lastname) {

        selectedStudentId = uid;

        document.getElementById("selected-student-name").textContent = `${firstname} ${lastname}`;

        document.getElementById("teacher-chat-section").style.display = "block";

        

        // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –≤–∏–±—Ä–∞–Ω–æ–≥–æ —É—á–Ω—è

        document.querySelectorAll(".student-item").forEach(item => {

            item.classList.remove("active");

            if (item.textContent.includes(firstname) && item.textContent.includes(lastname)) {

                item.classList.add("active");

            }

        });

        

        loadChatMessages(uid);

    }



    function backToStudents() {

        selectedStudentId = null;

        document.getElementById("teacher-chat-section").style.display = "none";

        if (chatListener) {

            db.ref(`chats/${selectedStudentId}`).off("value", chatListener);

            chatListener = null;

        }

    }



    async function loadChatMessages(otherUserId) {

        const messagesDiv = isTeacher(currentUser) 

            ? document.getElementById("teacher-messages")

            : document.getElementById("student-messages");

            

        messagesDiv.innerHTML = "";

        

        // –ó—É–ø–∏–Ω—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π listener

        if (chatListener) {

            const chatPath = isTeacher(currentUser) 

                ? `chats/${otherUserId}` 

                : `chats/${currentUser.uid}`;

            db.ref(chatPath).off("value", chatListener);

        }

        

        const chatPath = isTeacher(currentUser) 

            ? `chats/${otherUserId}` 

            : `chats/${currentUser.uid}`;

        

        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —ñ—Å–Ω—É—é—á—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

        try {

            const snap = await db.ref(chatPath).get();

            if (snap.exists()) {

                const messages = snap.val();

                Object.keys(messages).sort().forEach(key => {

                    renderMessage(messages[key], messagesDiv);

                });

            }

        } catch (e) {

            console.error("loadChatMessages error", e);

        }

        

        // –°–ª—É—Ö–∞—î–º–æ –Ω–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

        chatListener = (snap) => {

            if (snap.exists()) {

                const messages = snap.val();

                messagesDiv.innerHTML = "";

                Object.keys(messages).sort().forEach(key => {

                    renderMessage(messages[key], messagesDiv);

                });

                messagesDiv.scrollTop = messagesDiv.scrollHeight;

            }

        };

        

        db.ref(chatPath).on("value", chatListener);

        

        // –ü—Ä–æ–∫—Ä—É—á—É—î–º–æ –¥–æ –Ω–∏–∑—É

        setTimeout(() => {

            messagesDiv.scrollTop = messagesDiv.scrollHeight;

        }, 100);

    }



    function renderMessage(msg, container) {

        const div = document.createElement("div");

        div.className = `message ${msg.from === "teacher" ? "teacher" : "student"}`;

        

        const isCurrentUser = (isTeacher(currentUser) && msg.from === "teacher") ||

                              (!isTeacher(currentUser) && msg.from === "student");

        

        div.innerHTML = `

            <div>${msg.text}</div>

            <div class="message-time">${new Date(msg.timestamp).toLocaleString("uk-UA")}</div>

        `;

        

        container.appendChild(div);

    }



    async function sendMessage(text, from) {

        if (!text.trim()) return;

        

        const chatPath = isTeacher(currentUser) 

            ? `chats/${selectedStudentId}` 

            : `chats/${currentUser.uid}`;

        

        const message = {

            text: text.trim(),

            from: from,

            timestamp: Date.now()

        };

        

        try {

            await db.ref(`${chatPath}/${Date.now()}`).set(message);

            

            // –û—á–∏—â–∞—î–º–æ –ø–æ–ª–µ –≤–≤–æ–¥—É

            if (isTeacher(currentUser)) {

                document.getElementById("teacher-message-input").value = "";

            } else {

                document.getElementById("student-message-input").value = "";

            }

        } catch (e) {

            console.error("sendMessage error", e);

            alert("–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è");

        }

    }



    function showChatView() {

        if (!currentUser) {

            document.getElementById("chat-login-prompt").style.display = "block";

            document.getElementById("teacher-view").style.display = "none";

            document.getElementById("student-view").style.display = "none";

            return;

        }

        

        document.getElementById("chat-login-prompt").style.display = "none";

        

        if (isTeacher(currentUser)) {

            document.getElementById("teacher-view").style.display = "block";

            document.getElementById("student-view").style.display = "none";

            loadStudentsList();

        } else {

            document.getElementById("teacher-view").style.display = "none";

            document.getElementById("student-view").style.display = "block";

            loadChatMessages(currentUser.uid);

        }

    }



    // –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –¥–ª—è —á–∞—Ç—É

    const teacherSendBtn = document.getElementById("teacher-send-btn");

    const studentSendBtn = document.getElementById("student-send-btn");

    const backToStudentsBtn = document.getElementById("back-to-students");



    if (teacherSendBtn) {

        teacherSendBtn.addEventListener("click", () => {

            const input = document.getElementById("teacher-message-input");

            sendMessage(input.value, "teacher");

        });

        

        document.getElementById("teacher-message-input")?.addEventListener("keypress", (e) => {

            if (e.key === "Enter") {

                teacherSendBtn.click();

            }

        });

    }



    if (studentSendBtn) {

        studentSendBtn.addEventListener("click", () => {

            const input = document.getElementById("student-message-input");

            sendMessage(input.value, "student");

        });

        

        document.getElementById("student-message-input")?.addEventListener("keypress", (e) => {

            if (e.key === "Enter") {

                studentSendBtn.click();

            }

        });

    }



    if (backToStudentsBtn) {

        backToStudentsBtn.addEventListener("click", backToStudents);

    }



    // ========== –°–ò–°–¢–ï–ú–ê –ö–£–†–°–Ü–í –¢–ê –û–ü–õ–ê–¢–ò ==========

    

    const CARD_NUMBER = "4441114465300463";

    const CARD_NUMBER_DISPLAY = "4441 1144 6530 0463";

    

    // –î–∞–Ω—ñ –∫—É—Ä—Å—ñ–≤

    const COURSES = {

        beginner: {

            id: 'beginner',

            name: '–ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∫—É—Ä—Å',

            price: 10,

            level: 'A1-A2'

        },

        advanced: {

            id: 'advanced',

            name: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∏–π –∫—É—Ä—Å',

            price: 10,

            level: 'B1-B2'

        }

    };

    

    let selectedCourse = null;

    

    // –í—ñ–¥–∫—Ä–∏—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø–æ–∫—É–ø–∫–∏

    function openPurchaseModal(courseId, courseName, price) {

        if (!currentUser) {

            document.getElementById("courses-login-prompt").style.display = "block";

            return;

        }

        

        selectedCourse = { courseId, courseName, price };

        

        document.getElementById("modal-course-name").textContent = `–ö—É–ø–∏—Ç–∏: ${courseName}`;

        document.getElementById("modal-price").textContent = `${price} ‚Ç¥`;

        document.getElementById("modal-price-text").textContent = `${price} –≥—Ä–Ω`;

        document.getElementById("modal-comment").textContent = currentUser.email;

        

        document.getElementById("purchase-modal").classList.add("show");

    }

    

    // –ó–∞–∫—Ä–∏—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ

    function closePurchaseModal() {

        document.getElementById("purchase-modal").classList.remove("show");

        selectedCourse = null;

    }

    

    // –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏

    function copyCardNumber() {

        navigator.clipboard.writeText(CARD_NUMBER).then(() => {

            const btn = document.querySelector(".copy-btn");

            btn.textContent = "‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!";

            setTimeout(() => {

                btn.textContent = "üìã –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–æ–º–µ—Ä";

            }, 2000);

        });

    }

    

    // –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –æ–ø–ª–∞—Ç—É (—Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞—è–≤–∫—É)

    async function confirmPayment() {

        if (!currentUser || !selectedCourse) {

            alert("–ü–æ–º–∏–ª–∫–∞: —É–≤—ñ–π–¥—ñ—Ç—å –≤ –∞–∫–∞—É–Ω—Ç");

            return;

        }

        

        try {

            // –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –≤–∂–µ —î –∑–∞—è–≤–∫–∞ –≤ –ø—Ä–æ—Ñ—ñ–ª—ñ

            const existingSnap = await db.ref(`profiles/${currentUser.uid}/purchases/${selectedCourse.courseId}`).get();

            if (existingSnap.exists()) {

                const existing = existingSnap.val();

                if (existing.status === 'pending') {

                    alert("–í–∏ –≤–∂–µ –Ω–∞–¥—ñ—Å–ª–∞–ª–∏ –∑–∞—è–≤–∫—É –Ω–∞ —Ü–µ–π –∫—É—Ä—Å. –û—á—ñ–∫—É–π—Ç–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è!");

                } else if (existing.status === 'approved') {

                    alert("–í–∏ –≤–∂–µ –º–∞—î—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—å–æ–≥–æ –∫—É—Ä—Å—É!");

                }

                closePurchaseModal();

                return;

            }

            

            // –û—Ç—Ä–∏–º–∞—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

            let userName = currentUser.email;

            if (currentProfile && currentProfile.firstname) {

                userName = `${currentProfile.firstname} ${currentProfile.lastname || ''}`.trim();

            }

            

            const timestamp = Date.now();

            

            // –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞—è–≤–∫—É

            const purchase = {

                oderId: `${timestamp}_${currentUser.uid}`,

                userId: currentUser.uid,

                userEmail: currentUser.email,

                userName: userName,

                courseId: selectedCourse.courseId,

                courseName: selectedCourse.courseName,

                price: selectedCourse.price,

                status: 'pending',

                timestamp: timestamp,

                createdAt: new Date().toISOString()

            };

            

            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –ø—Ä–æ—Ñ—ñ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

            console.log("–ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∑–∞—è–≤–∫—É...", purchase);

            await db.ref(`profiles/${currentUser.uid}/purchases/${selectedCourse.courseId}`).set(purchase);

            console.log("–ó–∞—è–≤–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ!");

            

            closePurchaseModal();

            alert("‚úÖ –ó–∞—è–≤–∫—É –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ!\n\n–í—á–∏—Ç–µ–ª—å –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å –æ–ø–ª–∞—Ç—É —ñ –Ω–∞–¥–∞—Å—Ç—å –≤–∞–º –¥–æ—Å—Ç—É–ø. –ó–∞–∑–≤–∏—á–∞–π —Ü–µ –∑–∞–π–º–∞—î –¥–æ 24 –≥–æ–¥–∏–Ω.");

            

            // –û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∫—É—Ä—Å—É

            updateCourseStatus(selectedCourse.courseId, 'pending');

            loadMyCourses();

            

        } catch (e) {

            console.error("confirmPayment error", e);

            alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∑–∞—è–≤–∫–∏:\n" + e.message + "\n\n–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Firebase Rules!");

        }

    }

    

    // –û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∫—É—Ä—Å—É –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ

    function updateCourseStatus(courseId, status) {

        const statusDiv = document.getElementById(`course-${courseId}-status`);

        const accessDiv = document.getElementById(`course-${courseId}-access`);

        const card = document.getElementById(`course-${courseId}-card`);

        const buyBtn = card?.querySelector('button[onclick*="openPurchaseModal"]');

        

        if (status === 'pending') {

            statusDiv.innerHTML = '<span class="course-status pending">‚è≥ –û—á—ñ–∫—É—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è</span>';

            if (buyBtn) buyBtn.style.display = 'none';

            accessDiv.style.display = 'none';

        } else if (status === 'approved') {

            statusDiv.innerHTML = '<span class="course-status purchased">‚úÖ –ö—É–ø–ª–µ–Ω–æ</span>';

            if (buyBtn) buyBtn.style.display = 'none';

            accessDiv.style.display = 'block';

        } else {

            statusDiv.innerHTML = '';

            if (buyBtn) buyBtn.style.display = 'block';

            accessDiv.style.display = 'none';

        }

    }

    

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∫—É—Ä—Å—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

    async function loadUserCourses() {

        if (!currentUser) return;

        

        try {

            // –ß–∏—Ç–∞—î–º–æ –∑ –ø—Ä–æ—Ñ—ñ–ª—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

            const snap = await db.ref(`profiles/${currentUser.uid}/purchases`).get();

            

            // –°–∫–∏–¥–∞—î–º–æ —Å—Ç–∞—Ç—É—Å–∏

            updateCourseStatus('beginner', null);

            updateCourseStatus('advanced', null);

            

            if (!snap.exists()) return;

            

            const purchases = snap.val();

            

            // –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫—É—Ä—Å–∏

            const linksSnap = await db.ref('settings/courseLinks').get();

            const links = linksSnap.exists() ? linksSnap.val() : {};

            

            for (const courseId in purchases) {

                const p = purchases[courseId];

                updateCourseStatus(p.courseId, p.status);

                

                // –Ø–∫—â–æ –∫—É—Ä—Å –∫—É–ø–ª–µ–Ω–æ - –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

                if (p.status === 'approved' && links[p.courseId]) {

                    const linkEl = document.getElementById(`${p.courseId}-access-link`);

                    if (linkEl) {

                        linkEl.href = links[p.courseId];

                    }

                }

            }

        } catch (e) {

            console.error("loadUserCourses error", e);

        }

    }

    

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–æ—ó –∫—É—Ä—Å–∏ –≤ –∫–∞–±—ñ–Ω–µ—Ç—ñ

    async function loadMyCourses() {

        if (!currentUser) return;

        

        const myCoursesSection = document.getElementById("my-courses-section");

        const myCoursesDiv = document.getElementById("my-courses-list");

        

        try {

            // –ß–∏—Ç–∞—î–º–æ –∑ –ø—Ä–æ—Ñ—ñ–ª—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

            const snap = await db.ref(`profiles/${currentUser.uid}/purchases`).get();

            

            if (!snap.exists()) {

                myCoursesSection.style.display = "block";

                myCoursesDiv.innerHTML = '<p style="color:var(--muted);">–£ –≤–∞—Å –ø–æ–∫–∏ –Ω–µ–º–∞—î –∫—É–ø–ª–µ–Ω–∏—Ö –∫—É—Ä—Å—ñ–≤. <a href="#" onclick="openPage(\'courses\');return false;">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∫—É—Ä—Å–∏</a></p>';

                return;

            }

            

            const purchases = snap.val();

            const linksSnap = await db.ref('settings/courseLinks').get();

            const links = linksSnap.exists() ? linksSnap.val() : {};

            

            let html = '';

            let hasCourses = false;

            

            for (const key in purchases) {

                const p = purchases[key];

                hasCourses = true;

                

                let statusBadge = '';

                let accessBtn = '';

                

                if (p.status === 'pending') {

                    statusBadge = '<span class="course-status pending">‚è≥ –û—á—ñ–∫—É—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è</span>';

                } else if (p.status === 'approved') {

                    statusBadge = '<span class="course-status purchased">‚úÖ –î–æ—Å—Ç—É–ø –≤—ñ–¥–∫—Ä–∏—Ç–æ</span>';

                    if (links[p.courseId]) {

                        accessBtn = `<a href="${links[p.courseId]}" target="_blank" class="btn btn-success btn-sm">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –∫—É—Ä—Å—É</a>`;

                    } else {

                        accessBtn = '<span style="color:var(--muted);font-size:12px;">–ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ—Ä–æ –±—É–¥–µ –¥–æ–¥–∞–Ω–æ</span>';

                    }

                }

                

                html += `

                    <div class="my-course-item">

                        <div>

                            <strong>${p.courseName}</strong>

                            <div style="margin-top:4px;">${statusBadge}</div>

                        </div>

                        <div>${accessBtn}</div>

                    </div>

                `;

            }

            

            myCoursesSection.style.display = "block";

            myCoursesDiv.innerHTML = hasCourses ? html : '<p style="color:var(--muted);">–£ –≤–∞—Å –ø–æ–∫–∏ –Ω–µ–º–∞—î –∫—É–ø–ª–µ–Ω–∏—Ö –∫—É—Ä—Å—ñ–≤.</p>';

            

        } catch (e) {

            console.error("loadMyCourses error", e);

        }

    }

    

    // ========== –ê–î–ú–Ü–ù –ü–ê–ù–ï–õ–¨ ==========

    

    // –ü–æ–∫–∞–∑–∞—Ç–∏ –∞–¥–º—ñ–Ω –∫–Ω–æ–ø–∫—É –¥–ª—è –≤—á–∏—Ç–µ–ª—è

    function checkAdminAccess() {

        const adminBtn = document.getElementById("admin-nav-btn");

        if (currentUser && isTeacher(currentUser)) {

            adminBtn.style.display = "block";

        } else {

            adminBtn.style.display = "none";

        }

    }

    

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–∞—è–≤–∫–∏ (–∞–¥–º—ñ–Ω)

    async function loadPurchases() {

        if (!currentUser || !isTeacher(currentUser)) return;

        

        const pendingDiv = document.getElementById("pending-purchases");

        const approvedDiv = document.getElementById("approved-purchases");

        

        try {

            // –ß–∏—Ç–∞—î–º–æ –≤—Å—ñ –ø—Ä–æ—Ñ—ñ–ª—ñ —ñ –∑–±–∏—Ä–∞—î–º–æ –ø–æ–∫—É–ø–∫–∏

            const profilesSnap = await db.ref('profiles').get();

            

            if (!profilesSnap.exists()) {

                pendingDiv.innerHTML = '<p style="color:var(--muted);">–ù–µ–º–∞—î –∑–∞—è–≤–æ–∫</p>';

                approvedDiv.innerHTML = '<p style="color:var(--muted);">–ù–µ–º–∞—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö –ø–æ–∫—É–ø–æ–∫</p>';

                return;

            }

            

            const profiles = profilesSnap.val();

            let allPurchases = [];

            

            // –ó–±–∏—Ä–∞—î–º–æ –≤—Å—ñ –ø–æ–∫—É–ø–∫–∏ –∑ —É—Å—ñ—Ö –ø—Ä–æ—Ñ—ñ–ª—ñ–≤

            for (const userId in profiles) {

                const profile = profiles[userId];

                if (profile.purchases) {

                    for (const courseId in profile.purchases) {

                        allPurchases.push({

                            ...profile.purchases[courseId],

                            oderId: `${userId}_${courseId}`,

                            userId: userId,

                            courseId: courseId

                        });

                    }

                }

            }

            

            if (allPurchases.length === 0) {

                pendingDiv.innerHTML = '<p style="color:var(--muted);">–ù–µ–º–∞—î –∑–∞—è–≤–æ–∫</p>';

                approvedDiv.innerHTML = '<p style="color:var(--muted);">–ù–µ–º–∞—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö –ø–æ–∫—É–ø–æ–∫</p>';

                return;

            }

            

            let pendingHtml = '';

            let approvedHtml = '';

            let pendingCount = 0;

            let approvedCount = 0;

            

            // –°–æ—Ä—Ç—É—î–º–æ –ø–æ –¥–∞—Ç—ñ (–Ω–æ–≤—ñ –∑–≤–µ—Ä—Ö—É)

            allPurchases.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));

            

            for (const p of allPurchases) {

                const date = new Date(p.timestamp).toLocaleString('uk-UA');

                

                if (p.status === 'pending') {

                    pendingCount++;

                    pendingHtml += `

                        <div class="purchase-item pending">

                            <div><strong>${p.userName || p.userEmail}</strong></div>

                            <div style="font-size:13px;color:var(--muted);">${p.userEmail}</div>

                            <div style="margin-top:8px;">

                                <strong>${p.courseName}</strong> ‚Äî ${p.price} –≥—Ä–Ω

                            </div>

                            <div style="font-size:12px;color:var(--muted);margin-top:4px;">${date}</div>

                            <div class="purchase-actions">

                                <button class="btn btn-approve btn-sm" onclick="approvePurchase('${p.userId}', '${p.courseId}')">‚úÖ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>

                                <button class="btn btn-reject btn-sm" onclick="rejectPurchase('${p.userId}', '${p.courseId}')">‚ùå –í—ñ–¥—Ö–∏–ª–∏—Ç–∏</button>

                            </div>

                        </div>

                    `;

                } else if (p.status === 'approved') {

                    approvedCount++;

                    approvedHtml += `

                        <div class="purchase-item approved">

                            <div><strong>${p.userName || p.userEmail}</strong></div>

                            <div style="font-size:13px;color:var(--muted);">${p.userEmail}</div>

                            <div style="margin-top:8px;">

                                <strong>${p.courseName}</strong> ‚Äî ${p.price} –≥—Ä–Ω

                            </div>

                            <div style="font-size:12px;color:var(--muted);margin-top:4px;">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ: ${date}</div>

                        </div>

                    `;

                }

            }

            

            pendingDiv.innerHTML = pendingCount > 0 ? pendingHtml : '<p style="color:var(--muted);">–ù–µ–º–∞—î –Ω–æ–≤–∏—Ö –∑–∞—è–≤–æ–∫</p>';

            approvedDiv.innerHTML = approvedCount > 0 ? approvedHtml : '<p style="color:var(--muted);">–ù–µ–º–∞—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö –ø–æ–∫—É–ø–æ–∫</p>';

            

        } catch (e) {

            console.error("loadPurchases error", e);

        }

    }

    

    // –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –ø–æ–∫—É–ø–∫—É

    async function approvePurchase(userId, courseId) {

        if (!confirm("–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –æ–ø–ª–∞—Ç—É?")) return;

        

        try {

            // –û–Ω–æ–≤–ª—é—î–º–æ –≤ –ø—Ä–æ—Ñ—ñ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

            await db.ref(`profiles/${userId}/purchases/${courseId}/status`).set('approved');

            await db.ref(`profiles/${userId}/purchases/${courseId}/approvedAt`).set(Date.now());

            alert("‚úÖ –ü–æ–∫—É–ø–∫—É –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ! –£—á–µ–Ω—å –æ—Ç—Ä–∏–º–∞–≤ –¥–æ—Å—Ç—É–ø.");

            loadPurchases();

        } catch (e) {

            console.error("approvePurchase error", e);

            alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—ñ");

        }

    }

    

    // –í—ñ–¥—Ö–∏–ª–∏—Ç–∏ –ø–æ–∫—É–ø–∫—É

    async function rejectPurchase(userId, courseId) {

        if (!confirm("–í—ñ–¥—Ö–∏–ª–∏—Ç–∏ –∑–∞—è–≤–∫—É? (—è–∫—â–æ –æ–ø–ª–∞—Ç–∞ –Ω–µ –Ω–∞–¥—ñ–π—à–ª–∞)")) return;

        

        try {

            // –í–∏–¥–∞–ª—è—î–º–æ –∑–∞—è–≤–∫—É –∑ –ø—Ä–æ—Ñ—ñ–ª—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

            await db.ref(`profiles/${userId}/purchases/${courseId}`).remove();

            alert("–ó–∞—è–≤–∫—É –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ.");

            loadPurchases();

        } catch (e) {

            console.error("rejectPurchase error", e);

            alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—ñ");

        }

    }

    

    // –ó–±–µ—Ä–µ–≥—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫—É—Ä—Å–∏

    async function saveCourseLinks() {

        const beginnerLink = document.getElementById("beginner-course-link").value.trim();

        const advancedLink = document.getElementById("advanced-course-link").value.trim();

        

        try {

            await db.ref('settings/courseLinks').set({

                beginner: beginnerLink,

                advanced: advancedLink

            });

            alert("‚úÖ –ü–æ—Å–∏–ª–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ!");

        } catch (e) {

            console.error("saveCourseLinks error", e);

            alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ");

        }

    }

    

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫—É—Ä—Å–∏ (–∞–¥–º—ñ–Ω)

    async function loadCourseLinks() {

        try {

            const snap = await db.ref('settings/courseLinks').get();

            if (snap.exists()) {

                const links = snap.val();

                document.getElementById("beginner-course-link").value = links.beginner || '';

                document.getElementById("advanced-course-link").value = links.advanced || '';

            }

        } catch (e) {

            console.error("loadCourseLinks error", e);

        }

    }

    

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏

    const originalOpenPage = openPage;

    openPage = function(pageName) {

        originalOpenPage(pageName);

        

        if (pageName === 'courses' && currentUser) {

            loadUserCourses();

            document.getElementById("courses-login-prompt").style.display = "none";

        } else if (pageName === 'courses' && !currentUser) {

            document.getElementById("courses-login-prompt").style.display = "block";

        }

        

        if (pageName === 'admin' && currentUser && isTeacher(currentUser)) {

            loadPurchases();

            loadCourseLinks();

        }

    };

    

    // –î–æ–¥–∞—Ç–∫–æ–≤–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

    const originalShowCabinet = showCabinet;

    showCabinet = async function(user) {

        await originalShowCabinet(user);

        checkAdminAccess();

        loadMyCourses();

        

        // –Ø–∫—â–æ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –∫—É—Ä—Å—ñ–≤ - –æ–Ω–æ–≤–∏—Ç–∏

        if (document.getElementById("page-courses")?.classList.contains("page-active")) {

            loadUserCourses();

            document.getElementById("courses-login-prompt").style.display = "none";

        }

    };

    

    // –ó–∞–∫—Ä–∏—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –Ω–∏–º

    document.getElementById("purchase-modal").addEventListener("click", function(e) {

        if (e.target === this) {

            closePurchaseModal();

        }

    });

    

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ

    document.addEventListener("DOMContentLoaded", function() {

        checkAdminAccess();

    });



    // ========== –ß–ê–¢ –í–Ü–î–ñ–ï–¢ ==========

    

    let chatOpen = false;

    let widgetChatListener = null;

    

    function toggleChat() {

        chatOpen = !chatOpen;

        document.getElementById("chat-box").classList.toggle("open", chatOpen);

        

        if (chatOpen && currentUser) {

            loadWidgetChat();

            document.getElementById("widget-login-msg").style.display = "none";

            document.getElementById("widget-input-area").style.display = "flex";

        } else if (chatOpen && !currentUser) {

            document.getElementById("widget-login-msg").style.display = "block";

            document.getElementById("widget-input-area").style.display = "none";

        }

    }

    

    async function loadWidgetChat() {

        if (!currentUser) return;

        

        const messagesDiv = document.getElementById("widget-messages");

        const chatPath = `chats/${currentUser.uid}`;

        

        if (widgetChatListener) {

            db.ref(chatPath).off("value", widgetChatListener);

        }

        

        widgetChatListener = (snap) => {

            messagesDiv.innerHTML = "";

            if (snap.exists()) {

                const messages = snap.val();

                Object.keys(messages).sort().forEach(key => {

                    const msg = messages[key];

                    const div = document.createElement("div");

                    div.className = `message ${msg.from === "teacher" ? "teacher" : "student"}`;

                    div.innerHTML = `<div>${msg.text}</div><div class="message-time">${new Date(msg.timestamp).toLocaleTimeString("uk-UA", {hour: '2-digit', minute: '2-digit'})}</div>`;

                    messagesDiv.appendChild(div);

                });

                messagesDiv.scrollTop = messagesDiv.scrollHeight;

            } else {

                messagesDiv.innerHTML = '<p style="text-align:center;color:var(--muted);font-size:13px;">–ù–∞–ø–∏—à—ñ—Ç—å –ø–µ—Ä—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è! üëã</p>';

            }

        };

        

        db.ref(chatPath).on("value", widgetChatListener);

    }

    

    async function sendWidgetMessage() {

        if (!currentUser) return;

        const input = document.getElementById("widget-message-input");

        const text = input.value.trim();

        if (!text) return;

        

        const chatPath = `chats/${currentUser.uid}`;

        const message = { text: text, from: isTeacher(currentUser) ? "teacher" : "student", timestamp: Date.now() };

        

        try {

            await db.ref(`${chatPath}/${Date.now()}`).set(message);

            input.value = "";

        } catch (e) { console.error("sendWidgetMessage error", e); }

    }

    

    document.getElementById("widget-message-input")?.addEventListener("keypress", (e) => {

        if (e.key === "Enter") sendWidgetMessage();

    });



    // ========== –¢–ê–†–ò–§–ò ==========

    

    let selectedTariff = null;

    

    // Telegram Bot –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

    const TELEGRAM_BOT_TOKEN = "8360726167:AAED6i6vVwfWQ2qe4a-ZxoxRHWoYKGdaAbk";

    const TELEGRAM_CHAT_ID = "1170987945";

    

    function openTariffModal(tariffId, tariffName, price, lessons) {

        selectedTariff = { tariffId, tariffName, price, lessons };

        document.getElementById("tariff-modal-title").textContent = `–ó–∞–ø–∏—Å–∞—Ç–∏—Å—å: ${tariffName}`;

        document.getElementById("tariff-modal-price").textContent = tariffName;

        document.getElementById("tariff-modal-lessons").textContent = lessons === 1 ? "–ü—Ä–æ–±–Ω–∏–π —É—Ä–æ–∫" : `${lessons} –∑–∞–Ω—è—Ç—å`;

        document.getElementById("tariff-modal").classList.add("show");

    }

    

    function closeTariffModal() {

        document.getElementById("tariff-modal").classList.remove("show");

        selectedTariff = null;

    }

    

    async function submitTariffRequest() {

        const name = document.getElementById("tariff-name").value.trim();

        const contact = document.getElementById("tariff-contact").value.trim();

        

        if (!name) { alert("–í–∫–∞–∂—ñ—Ç—å –≤–∞—à–µ —ñ–º'—è!"); return; }

        if (!contact) { alert("–í–∫–∞–∂—ñ—Ç—å –≤–∞—à Telegram –∞–±–æ —Ç–µ–ª–µ—Ñ–æ–Ω!"); return; }

        

        if (!selectedTariff) {

            alert("–ü–æ–º–∏–ª–∫–∞: —Ç–∞—Ä–∏—Ñ –Ω–µ –æ–±—Ä–∞–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.");

            return;

        }

        

        const tariffName = selectedTariff.tariffName;

        const lessons = selectedTariff.lessons;

        

        // –§–æ—Ä–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è Telegram

        const message = `üéì –ù–û–í–ê –ó–ê–Ø–í–ö–ê!\n\n` +

            `üìö –¢–∞—Ä–∏—Ñ: ${tariffName}\n` +

            `üë§ –Ü–º'—è: ${name}\n` +

            `üìû –ö–æ–Ω—Ç–∞–∫—Ç: ${contact}\n` +

            `üìÖ –î–∞—Ç–∞: ${new Date().toLocaleString('uk-UA')}\n` +

            `${currentUser ? `üìß Email: ${currentUser.email}` : ''}`;

        

        try {

            // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤ Telegram

            await sendToTelegram(message);

            

            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ Firebase —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π

            if (currentUser) {

                await db.ref(`profiles/${currentUser.uid}/tariffRequests/${selectedTariff.tariffId}`).set({

                    tariffId: selectedTariff.tariffId,

                    tariffName: tariffName,

                    lessons: lessons,

                    name: name,

                    contact: contact,

                    userEmail: currentUser.email,

                    status: "pending",

                    timestamp: Date.now()

                });

            }

            

            document.getElementById("tariff-name").value = "";

            document.getElementById("tariff-contact").value = "";

            document.getElementById("tariff-modal").classList.remove("show");

            selectedTariff = null;

            

            alert("‚úÖ –ó–∞—è–≤–∫—É –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ!\n\n–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–≤'—è–∂–µ—Ç—å—Å—è –∑ –≤–∞–º–∏ –ø—Ä–æ—Ç—è–≥–æ–º 24 –≥–æ–¥–∏–Ω –¥–ª—è –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è –¥–µ—Ç–∞–ª–µ–π.");

            

        } catch (e) {

            console.error("submitTariffRequest error", e);

            alert("–ó–∞—è–≤–∫—É –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ! –ú–∏ —Å–∫–æ—Ä–æ –∑–≤'—è–∂–µ–º–æ—Å—å –∑ –≤–∞–º–∏.");

            document.getElementById("tariff-modal").classList.remove("show");

        }

    }

    

    // –§—É–Ω–∫—Ü—ñ—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –≤ Telegram

    async function sendToTelegram(message) {

        const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;

        

        const response = await fetch(url, {

            method: 'POST',

            headers: { 'Content-Type': 'application/json' },

            body: JSON.stringify({

                chat_id: TELEGRAM_CHAT_ID,

                text: message,

                parse_mode: 'HTML'

            })

        });

        

        if (!response.ok) {

            console.error("Telegram API error:", await response.text());

        }

        

        return response;

    }

    

    async function sendGeneralRequest() {

        const name = document.getElementById("request-name").value.trim();

        const contact = document.getElementById("request-contact").value.trim();

        const statusDiv = document.getElementById("request-status");

        

        if (!name || !contact) { statusDiv.innerHTML = '<span class="error">–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è!</span>'; return; }

        

        try {

            // –§–æ—Ä–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è Telegram

            const message = `üìù –ó–ê–ì–ê–õ–¨–ù–ê –ó–ê–Ø–í–ö–ê\n\n` +

                `üë§ –Ü–º'—è: ${name}\n` +

                `üìû –ö–æ–Ω—Ç–∞–∫—Ç: ${contact}\n` +

                `üìÖ –î–∞—Ç–∞: ${new Date().toLocaleString('uk-UA')}\n` +

                `üí¨ –ü–æ—Ç—Ä—ñ–±–Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è –ø–æ —Ç–∞—Ä–∏—Ñ–∞—Ö`;

            

            // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤ Telegram

            await sendToTelegram(message);

            

            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ Firebase —è–∫—â–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π

            if (currentUser) {

                await db.ref(`profiles/${currentUser.uid}/generalRequests/${Date.now()}`).set({

                    name, contact, type: "general",

                    userEmail: currentUser.email,

                    timestamp: Date.now()

                });

            }

            

            document.getElementById("request-name").value = "";

            document.getElementById("request-contact").value = "";

            statusDiv.innerHTML = '<span class="success">‚úÖ –ó–∞—è–≤–∫—É –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ! –ú–∏ —Å–∫–æ—Ä–æ –∑–≤\'—è–∂–µ–º–æ—Å—å –∑ –≤–∞–º–∏.</span>';

            setTimeout(() => { statusDiv.innerHTML = ""; }, 5000);

        } catch (e) {

            console.error("sendGeneralRequest error", e);

            // –í—Å–µ –æ–¥–Ω–æ –ø–æ–∫–∞–∑—É—î–º–æ —É—Å–ø—ñ—Ö (–∑–∞—è–≤–∫–∞ –Ω–∞–¥—ñ–π—à–ª–∞ —Ö–æ—á–∞ –± –≤ –∫–æ–Ω—Å–æ–ª—å)

            statusDiv.innerHTML = '<span class="success">‚úÖ –ó–∞—è–≤–∫—É –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ!</span>';

            setTimeout(() => { statusDiv.innerHTML = ""; }, 5000);

        }

    }

    

    document.getElementById("tariff-modal")?.addEventListener("click", function(e) {

        if (e.target === this) closeTariffModal();

    });


</script>



</body>

</html>
